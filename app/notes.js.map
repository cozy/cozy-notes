{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/header_menu.jsx","webpack:///./src/locales sync ^\\.\\/.*$","webpack:///./src/styles/index.styl","webpack:///../locale-data/index.js (ignored)","webpack:///./lib/locales (ignored)","webpack:///./lib/locales (ignored)?a76a","webpack:///zlib (ignored)","webpack:///fs (ignored)","webpack:///http (ignored)","webpack:///https (ignored)","webpack:///./src/components/notes/editor-view.jsx","webpack:///./src/lib/collab/participant.js","webpack:///./src/lib/collab/channel.js","webpack:///./src/lib/collab/provider.js","webpack:///./src/assets/icons/icon-note-32.svg","webpack:///./src/targets/browser/index.jsx","webpack:///./src/components/notes/editor.jsx","webpack:///./src/components/notes/add.jsx","webpack:///./src/components/notes/editor-loading.jsx","webpack:///./src/targets/vendor/assets/icon.svg","webpack:///./src/components/IsPublic.jsx","webpack:///./src/components/notes/index.jsx","webpack:///./src/components/notes/list.jsx","webpack:///./src/lib/collab/stack-client.js","webpack:///./src/lib/collab/schema.js","webpack:///../create-cozy-app/packages/cozy-scripts/utils/reactExposer.js","webpack:///./src/components/notes/editor_config.js","webpack:///./src/components/notes/back_from_editing.jsx","webpack:///./node_modules/date-fns/locale sync ^\\.\\/.*\\/index\\.js$","webpack:///./src/components/app.jsx","webpack:///./manifest.webapp","webpack:///./src/lib/utils.js"],"names":["HeaderMenu","props","className","left","children","right","updateTextareaHeight","target","style","height","scrollHeight","EditorView","defaultValue","onTitleChange","onContentChange","defaultTitle","title","collabProvider","returnUrl","titleEl","useRef","onTitleEvent","useCallback","e","useEffect","current","editorConfig","getParticipant","userId","sessionId","name","avatar","replace","email","Channel","config","serviceClient","service","eventEmitter","EventEmitter2","version","doc","docId","join","onStepsCreated","data","emit","steps","onTelepointerUpdated","payload","getState","debounced","clearTimeout","window","setTimeout","sendSteps","state","localSteps","isSending","debounce","getVersion","undefined","sendableSteps","length","pushSteps","response","getSteps","pushTelepointer","evt","handler","on","off","jsonTransformer","JSONTransformer","CollabProvider","userIds","map","step","getUserId","json","console","warn","queueData","processQueue","participant","participants","get","lastActive","timestamp","updateParticipant","getSessionId","channel","queue","Map","pauseQueue","initialVersion","sid","onReceiveData","onReceiveTelepointer","encode","usableVersion","collabDoc","connect","tr","oldState","newState","type","sendTelepointer","Date","getTime","orderedQueue","sort","a","b","aStart","bStart","currentVersion","queueTimeout","programCatchup","catchup","first","firstVersion","expectedVersion","cancelCatchup","shift","processRemoteData","set","joined","now","Array","from","values","filter","p","forEach","delete","removeAllListeners","appLocale","renderApp","client","isPublic","App","require","default","render","document","querySelector","getDataOrDefault","toTest","defaultData","templateRegex","test","getDataset","root","dataset","getToken","cozyToken","token","arrToObj","obj","key","val","location","search","substring","split","varval","reduce","sharecode","addEventListener","appIcon","cozyIconPath","appNamePrefix","cozyAppNamePrefix","name_prefix","appName","cozyAppName","appSlug","cozyAppSlug","slug","appVersion","cozyAppVersion","cozyLocale","protocol","CozyClient","uri","cozyDomain","schema","appMetadata","cozy","bar","init","iconPath","lang","replaceTitleOnMobile","cozyClient","Editor","withClient","noteId","userName","useMemo","getShortNameFromClient","useState","loading","setLoading","setDoc","setTitle","ServiceClient","docVersion","provider","useNativePlugin","Promise","resolve","inviteToEditHandler","isInviteToEditButtonSelected","fn","getDoc","onLocalTitleChange","newTitle","value","modifiedTitle","onRemoteTitleChange","onTitleUpdated","history","push","getParentFolderLink","file","Add","context","setState","getStackClient","fetchJSON","attributes","schemaOrdered","href","generateReturnUrlToNotesIndex","isWorking","handleClick","Component","withRouter","EditorLoading","Link","IsPublic","React","createContext","titleWithDefault","Item","icon","note","id","Row","updatedAt","cozyMetadata","options","day","month","year","formatedUpdatedAt","toLocaleDateString","List","notes","_id","ListHeader","ConnectedList","fetchStatus","isLoading","sessionSuffix","getMilliseconds","Math","random","stackClient","onRealtimeEvent","bind","realtime","CozyRealtime","resetCallbacks","callbacks","callback","match","unsubscribeAll","toISOString","sub","sessionID","defaultSchema","path","titleDoc","client2server","doctype","onRealtimeCreated","all","subscribe","setCallback","server2client","res","metadata","content","headers","stepsDoc","toJSON","reason","meta","ver","status","ev","telepointerDoc","nodes","marks","group","parseDOM","tag","defining","attrs","level","selectable","panelType","cxhtml","inline","atom","originalValue","isNumberColumnEnabled","layout","__autoSize","tableRole","isolating","colspan","rowspan","colwidth","background","ignore","excludes","__confluenceMetadata","inclusive","color","preserveWhitespace","trigger","orderedToObject","ordered","acc","cur","schemaObject","Schema","allowTables","allowRule","allowLists","allowTextColor","allowPanel","BackFromEditing","useContext","RoutedEditor","getReturnUrl","params","PrivateContext","Unshared","translate","t","PublicContext","sharedDocumentId","setSharedDocumentId","fetchData","getSharedDocument","hot","module","url","URL","hostname","floor","returnUrlKey","searchParams","URLSearchParams","append","origin","hash","collection","getOwnPermissions","permissionsData","permissions","Object","getParentFolderId","relationships","parent","getFolderLink","getFullLink","cozyURL","getInstanceOptions","cozySubdomainType","driveSlug","pathForDrive","webUrl","generateWebLink","cozyUrl","subDomainType","nativePath","isMobile","urlWithUL","generateUniversalLink","fallbackUrl"],"mappings":";AAAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAQ,oBAAoB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAiB,4BAA4B;AAC7C;AACA;AACA,0BAAkB,2BAA2B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,kDAA0C;AAC1C;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA,kDAA0C,oBAAoB,WAAW;;AAEzE;AACA;AACA;AACA;AACA,wBAAgB,uBAAuB;AACvC;;;AAGA;AACA;AACA;AACA;;;;;;;;;ACrKA;AAAA;AAAA;AAAA;;AAEA,IAAMA,UAAU,GAAG,SAAbA,UAAa,CAAAC,KAAK;AAAA,SACtB;AAAQ,aAAS,EAAE,uBAAuBA,KAAK,CAACC,SAAN,IAAmB,EAA1C;AAAnB,KACE;AAAK,aAAS,EAAC;AAAf,KAAyCD,KAAK,CAACE,IAA/C,CADF,EAEGF,KAAK,CAACG,QAFT,EAGE;AAAK,aAAS,EAAC;AAAf,KAA0CH,KAAK,CAACI,KAAhD,CAHF,CADsB;AAAA,CAAxB;;AAQeL,yEAAf,E;;;;;;;ACVA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2B;;;;;;;ACvBA,uC;;;;;;;;;;;;;;;;;ACAA,e;;;;;;;ACAA,e;;;;;;;ACAA,e;;;;;;;ACAA,e;;;;;;;ACAA,e;;;;;;;ACAA,e;;;;;;;ACAA,e;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAA;AAEA;AAEA;AACA;AAEA;AACA;AACA;;AAEA,SAASM,oBAAT,CAA8BC,MAA9B,EAAsC;AACpCA,QAAM,CAACC,KAAP,CAAaC,MAAb,GAAsB,SAAtB;AACAF,QAAM,CAACC,KAAP,CAAaC,MAAb,aAAyBF,MAAM,CAACG,YAAhC;AACD;;AAEc,SAASC,UAAT,CAAoBV,KAApB,EAA2B;AAAA,MAEtCW,YAFsC,GASpCX,KAToC,CAEtCW,YAFsC;AAAA,MAGtCC,aAHsC,GASpCZ,KAToC,CAGtCY,aAHsC;AAAA,MAItCC,eAJsC,GASpCb,KAToC,CAItCa,eAJsC;AAAA,MAKtCC,YALsC,GASpCd,KAToC,CAKtCc,YALsC;AAAA,MAMtCC,KANsC,GASpCf,KAToC,CAMtCe,KANsC;AAAA,MAOtCC,cAPsC,GASpChB,KAToC,CAOtCgB,cAPsC;AAAA,MAQtCC,SARsC,GASpCjB,KAToC,CAQtCiB,SARsC;AAWxC,MAAMC,OAAO,GAAGC,oDAAM,CAAC,IAAD,CAAtB;AAEA,MAAMC,YAAY,GAAGC,yDAAW,CAC9B,UAAAC,CAAC,EAAI;AACH,QAAMhB,MAAM,GAAGgB,CAAC,CAAChB,MAAjB;AACAD,wBAAoB,CAACC,MAAD,CAApB;AACA,QAAIM,aAAJ,EAAmBA,aAAa,CAACU,CAAD,CAAb;AACpB,GAL6B,EAM9B,CAACV,aAAD,CAN8B,CAAhC;AASAW,yDAAS,CAAC;AAAA,WAAMlB,oBAAoB,CAACa,OAAO,CAACM,OAAT,CAA1B;AAAA,GAAD,EAA8C,EAA9C,CAAT;AAEA,SACE;AAAS,aAAS,EAAC;AAAnB,KACE,uFAAiB,mBAAjB,CADF,EAEE,2DAAC,oDAAD;AACE,QAAI,EAAE,2DAAC,0DAAD;AAAiB,eAAS,EAAEP;AAA5B,MADR;AAEE,aAAS,EAAC;AAFZ,IAFF,EAME;AAAS,aAAS,EAAC;AAAnB,KACE,2DAAC,4DAAD;AACE,cAAU,EAAED,cADd;AAEE,YAAQ,EAAEH,eAFZ;AAGE,gBAAY,EAAEF;AAHhB,KAIMc,sDAJN;AAKE,cAAU,EAAC,WALb;AAME,eAAW,EAAC,wBANd;AAOE,eAAW,EAAE,IAPf;AAQE,qBAAiB,EACf,2DAAC,uEAAD;AACE,YAAM,EAAE;AAAA,eACN,2DAAC,4DAAD;AAAW,aAAG,EAAC,IAAf;AAAoB,mBAAS,EAAC;AAA9B,WACE,2DAAC,8DAAD;AACE,aAAG,EAAEP,OADP;AAEE,cAAI,EAAC,GAFP;AAGE,mBAAS,EAAE,IAHb;AAIE,eAAK,EAAEH,KAJT;AAKE,kBAAQ,EAAEK,YALZ;AAME,qBAAW,EAAEN,YANf;AAOE,mBAAS,EAAC;AAPZ,UADF,CADM;AAAA;AADV;AATJ,KADF,CANF,CADF;AAqCD,C;;;;;;;;AC7ED;AAAA;AAAO,IAAMY,cAAc,GAAG,SAAjBA,cAAiB;AAAA,MAAGC,MAAH,QAAGA,MAAH;AAAA,MAAWC,SAAX,QAAWA,SAAX;AAAA,SAA4B;AACxDD,UAAM,EAAEC,SADgD;AAExDA,aAAS,EAAEA,SAAS,IAAID,MAFgC;AAGxDE,QAAI,EAAEF,MAHkD;AAIxDG,UAAM,+CAAwCH,MAAM,CAACI,OAAP,CAC5C,eAD4C,EAE5C,EAF4C,CAAxC,SAJkD;AAQxDC,SAAK,YAAKL,MAAM,CACbI,OADO,CACC,MADD,EACS,GADT,EAEPA,OAFO,CAEC,gBAFD,EAEmB,EAFnB,CAAL;AARmD,GAA5B;AAAA,CAAvB,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAP;AACA;AAEO,IAAME,OAAb;AAAA;AAAA;AACE,mBAAYC,MAAZ,EAAoBC,aAApB,EAAmC;AAAA;;AACjC,SAAKD,MAAL,GAAcA,MAAd;AACA,SAAKE,OAAL,GAAeD,aAAf;AACA,SAAKE,YAAL,GAAoB,IAAIC,2DAAJ,EAApB;AACD;AAED;;;;;AAPF;AAAA;AAAA;AAAA;AAAA;AAAA,8FAUgBC,OAVhB,EAUyBC,GAVzB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAWYC,qBAXZ,GAWsB,KAAKP,MAX3B,CAWYO,KAXZ;AAYI,qBAAKL,OAAL,CAAaM,IAAb,CAAkBD,KAAlB;AACA,qBAAKL,OAAL,CAAaO,cAAb,CAA4BF,KAA5B,EAAmC,UAAAG,IAAI,EAAI;AACzC,uBAAI,CAACC,IAAL,CAAU,MAAV,EAAkB;AAAEN,2BAAO,EAAEK,IAAI,CAACL,OAAhB;AAAyBO,yBAAK,EAAE,CAACF,IAAD;AAAhC,mBAAlB;AACD,iBAFD;AAGA,qBAAKR,OAAL,CAAaW,oBAAb,CAAkCN,KAAlC,EAAyC,UAAAO,OAAO,EAAI;AAClD,uBAAI,CAACH,IAAL,CAAU,aAAV,EAAyBG,OAAzB;AACD,iBAFD;AAGA,qBAAKX,YAAL,CAAkBQ,IAAlB,CAAuB,WAAvB,EAAoC;AAClCL,qBAAG,EAAHA,GADkC;AAElCD,yBAAO,EAAPA;AAFkC,iBAApC;;AAnBJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BAyBWU,QAzBX,EAyBqB;AAAA;;AACjB,UAAI,KAAKC,SAAT,EAAoB;AAClBC,oBAAY,CAAC,KAAKD,SAAN,CAAZ;AACD;;AAED,WAAKA,SAAL,GAAiBE,MAAM,CAACC,UAAP,CAAkB,YAAM;AACvC,cAAI,CAACC,SAAL,CAAeL,QAAQ,EAAvB,EAA2BA,QAA3B;AACD,OAFgB,EAEd,GAFc,CAAjB;AAGD;AAED;;;;AAnCF;AAAA;AAAA;AAAA;AAAA;AAAA,+FAsCkBM,KAtClB,EAsCyBN,QAtCzB,EAsCmCO,UAtCnC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAuCYf,qBAvCZ,GAuCsB,KAAKP,MAvC3B,CAuCYO,KAvCZ;;AAAA,qBAyCQ,KAAKgB,SAzCb;AAAA;AAAA;AAAA;;AA0CM,qBAAKC,QAAL,CAAcT,QAAd;AA1CN;;AAAA;AA8CUV,uBA9CV,GA8CoBoB,qEAAU,CAACJ,KAAD,CA9C9B,EAgDI;;AAhDJ,sBAiDQ,QAAOhB,OAAP,MAAmBqB,SAjD3B;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA,uBAqDsBJ,UAAU,IAAIK,wEAAa,CAACN,KAAD,CAA3B,IAAsC;AAAET,uBAAK,EAAE;AAAT,iBArD5D,EAqDYA,KArDZ,QAqDYA,KArDZ,EAqD0E;;AArD1E,sBAuDQA,KAAK,CAACgB,MAAN,KAAiB,CAvDzB;AAAA;AAAA;AAAA;;AAAA;;AAAA;AA2DI,qBAAKL,SAAL,GAAiB,IAAjB;AA3DJ;AAAA;AAAA,uBA6D6B,KAAKrB,OAAL,CAAa2B,SAAb,CAAuBtB,KAAvB,EAA8BF,OAA9B,EAAuCO,KAAvC,CA7D7B;;AAAA;AA6DYkB,wBA7DZ;AA8DM,qBAAKP,SAAL,GAAiB,KAAjB;;AACA,oBAAIO,QAAQ,IAAIA,QAAQ,CAAClB,KAArB,IAA8BkB,QAAQ,CAAClB,KAAT,CAAegB,MAAf,GAAwB,CAA1D,EAA6D;AAC3D,uBAAKjB,IAAL,CAAU,MAAV,EAAkBmB,QAAlB;AACD;;AAjEP;AAAA;;AAAA;AAAA;AAAA;AAmEM,qBAAKN,QAAL,CAAcT,QAAd;AACA,qBAAKQ,SAAL,GAAiB,KAAjB;;AApEN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAwEE;;;;AAxEF;AAAA;AAAA;AAAA;AAAA;AAAA,+FA2EiBlB,OA3EjB;AAAA;AAAA;AAAA;AAAA;AAAA;AA4EYE,qBA5EZ,GA4EsB,KAAKP,MA5E3B,CA4EYO,KA5EZ;AAAA;AAAA,uBA6EiB,KAAKL,OAAL,CAAa6B,QAAb,CAAsBxB,KAAtB,EAA6BF,OAA7B,CA7EjB;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAgFE;;;;AAhFF;AAAA;AAAA;AAAA;AAAA;AAAA,+FAmFwBK,IAnFxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAoFYH,qBApFZ,GAoFsB,KAAKP,MApF3B,CAoFYO,KApFZ;AAAA;AAAA,uBAqFiB,KAAKL,OAAL,CAAa8B,eAAb,CAA6BzB,KAA7B,EAAoCG,IAApC,CArFjB;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAwFE;;;;AAxFF;AAAA;AAAA,uBA2FKuB,GA3FL,EA2FUC,OA3FV,EA2FmB;AACf,WAAK/B,YAAL,CAAkBgC,EAAlB,CAAqBF,GAArB,EAA0BC,OAA1B;AACA,aAAO,IAAP;AACD;AAED;;;;AAhGF;AAAA;AAAA,wBAmGMD,GAnGN,EAmGWC,OAnGX,EAmGoB;AAChB,WAAK/B,YAAL,CAAkBiC,GAAlB,CAAsBH,GAAtB,EAA2BC,OAA3B;AACA,aAAO,IAAP;AACD;AAED;;;;AAxGF;AAAA;AAAA,yBA2GOD,GA3GP,EA2GYvB,IA3GZ,EA2GkB;AACd,WAAKP,YAAL,CAAkBQ,IAAlB,CAAuBsB,GAAvB,EAA4BvB,IAA5B;AACA,aAAO,IAAP;AACD;AA9GH;;AAAA;AAAA,I;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACHA;AACA;AACA;AACA;AACA;AAEA,IAAM2B,eAAe,GAAG,IAAIC,iFAAJ,EAAxB;AAEO,IAAMC,cAAb;AAAA;AAAA;AACE,0BAAYvC,MAAZ,EAAoBC,aAApB,EAAmC;AAAA;;AAAA;;AAAA,+CA2Jf,UAAAS,IAAI,EAAI;AAAA,UAClBL,OADkB,GACCK,IADD,CAClBL,OADkB;AAAA,UACTO,KADS,GACCF,IADD,CACTE,KADS;;AAG1B,UAAIA,KAAK,IAAIA,KAAK,CAACgB,MAAnB,EAA2B;AACzB,YAAMY,OAAO,GAAG5B,KAAK,CAAC6B,GAAN,CACd,UAAAC,IAAI;AAAA,iBAAIA,IAAI,CAAChD,SAAL,IAAkB,KAAI,CAACO,aAAL,CAAmB0C,SAAnB,CAA6BD,IAAI,CAAChD,SAAlC,CAAtB;AAAA,SADU,CAAhB;;AAGA,aAAI,CAACiB,IAAL,CAAU,MAAV,EAAkB;AAAEiC,cAAI,EAAEhC,KAAR;AAAeP,iBAAO,EAAPA,OAAf;AAAwBmC,iBAAO,EAAPA;AAAxB,SAAlB;AACD,OALD,MAKO;AACLK,eAAO,CAACC,IAAR,CACE,gDADF,EAEElC,KAFF,EAGEF,IAHF;AAKD;AACF,KA1KkC;;AAAA,2CA4KnB,UAAAA,IAAI,EAAI;AACtB,WAAI,CAACqC,SAAL,CAAerC,IAAf;;AACA,WAAI,CAACsC,YAAL;AACD,KA/KkC;;AAAA,kDAiLZ,UAAAtC,IAAI,EAAI;AAAA,UACrBhB,SADqB,GACPgB,IADO,CACrBhB,SADqB;;AAE7B,UAAMD,MAAM,GAAG,KAAI,CAACQ,aAAL,CAAmB0C,SAAnB,CAA6BjD,SAA7B,CAAf;;AACA,UAAID,MAAM,KAAK,KAAI,CAACO,MAAL,CAAYP,MAA3B,EAAmC;AACjC;AACD;;AAED,UAAMwD,WAAW,GAAG,KAAI,CAACC,YAAL,CAAkBC,GAAlB,CAAsB1D,MAAtB,CAApB;;AACA,UAAIwD,WAAW,IAAIA,WAAW,CAACG,UAAZ,GAAyB1C,IAAI,CAAC2C,SAAjD,EAA4D;AAC1D;AACD;;AAED,WAAI,CAACC,iBAAL,CAAuB5D,SAAvB,EAAkCgB,IAAI,CAAC2C,SAAvC;;AACA,WAAI,CAAC1C,IAAL,CAAU,aAAV,EAAyBD,IAAzB;AACD,KA/LkC;;AACjC,SAAKV,MAAL,GAAcA,MAAd;AACA,SAAKA,MAAL,CAAY,WAAZ,IAA2BC,aAAa,CAACsD,YAAd,EAA3B;AACA,SAAKvD,MAAL,CAAY,QAAZ,IAAwBC,aAAa,CAAC0C,SAAd,EAAxB;AACA,SAAK1C,aAAL,GAAqBA,aAArB;AACA,SAAKuD,OAAL,GAAexD,MAAM,CAACwD,OAAP,IAAkB,IAAIzD,gDAAJ,CAAYC,MAAZ,EAAoBC,aAApB,CAAjC;AACA,SAAKE,YAAL,GAAoB,IAAIC,2DAAJ,EAApB;AACA,SAAKqD,KAAL,GAAa,EAAb;;AACA,SAAK1C,QAAL,GAAgB,YAAM,CAAE,CAAxB;;AACA,SAAKmC,YAAL,GAAoB,IAAIQ,GAAJ,EAApB;AACA,SAAKC,UAAL,GAAkB,KAAlB;AACA,SAAKC,cAAL,GAAsB5D,MAAM,CAACK,OAA7B;AACD;;AAbH;AAAA;AAAA,+BAeaU,QAfb,EAeuB;AAAA;;AACnB,WAAKA,QAAL,GAAgBA,QAAhB;AACA,WAAKyC,OAAL,CAAarB,EAAb,CAAgB,WAAhB,EAA6B,gBAAsB;AAAA,YAAnB7B,GAAmB,QAAnBA,GAAmB;AAAA,YAAdD,OAAc,QAAdA,OAAc;AAAA,YACzCX,SADyC,GAC3B,MAAI,CAACM,MADsB,CACzCN,SADyC;;AAEjD,cAAI,CAACiB,IAAL,CAAU,MAAV,EAAkB;AAAEkD,aAAG,EAAEnE,SAAP;AAAkBY,aAAG,EAAHA,GAAlB;AAAuBD,iBAAO,EAAPA;AAAvB,SAAlB,EAFiD,CAEG;;;AACpD,cAAI,CAACM,IAAL,CAAU,WAAV,EAAuB;AAAEkD,aAAG,EAAEnE;AAAP,SAAvB,EAHiD,CAGN;;AAC5C,OAJD;AAKA,WAAK8D,OAAL,CAAarB,EAAb,CAAgB,MAAhB,EAAwB,KAAK2B,aAA7B;AACA,WAAKN,OAAL,CAAarB,EAAb,CAAgB,aAAhB,EAA+B,KAAK4B,oBAApC;AACA,UAAM1C,KAAK,GAAGN,QAAQ,EAAtB;AACA,UAAMT,GAAG,GAAG+B,eAAe,CAAC2B,MAAhB,CAAuB3C,KAAK,CAACf,GAA7B,CAAZ;AACA,UAAM2D,aAAa,GACjB,KAAKL,cAAL,KAAwBlC,SAAxB,GAAoC,KAAKkC,cAAzC,GAA0DtD,GAAG,CAACD,OADhE;;AAEA,UAAM6D,SAAS,qBAAQ5D,GAAR;AAAaD,eAAO,EAAE4D;AAAtB,QAAf;;AACA,WAAKT,OAAL,CAAaW,OAAb,CACEF,aADF,EAEEC,SAFF;AAKA,aAAO,IAAP;AACD;AAED;;;;AArCF;AAAA;AAAA,yBAwCOE,EAxCP,EAwCWC,QAxCX,EAwCqBC,QAxCrB,EAwC+B;AAC3B;AACA,UAAI,CAACF,EAAE,CAACxD,KAAJ,IAAa,CAACwD,EAAE,CAACxD,KAAH,CAASgB,MAA3B,EAAmC;AACjC;AACD;;AAED,WAAK4B,OAAL,CAAapC,SAAb,CAAuBkD,QAAvB,EAAiC,KAAKvD,QAAtC;AACD;AAED;;;;AAjDF;AAAA;AAAA,gCAoDcL,IApDd,EAoDoB;AAChB,UAAI,CAACA,IAAL,EAAW;AACT;AACD;;AAHe,UAKR6D,IALQ,GAKC7D,IALD,CAKR6D,IALQ;;AAMhB,cAAQA,IAAR;AACE,aAAK,aAAL;AACE,eAAKf,OAAL,CAAagB,eAAb,mBACK9D,IADL;AAEE2C,qBAAS,EAAE,IAAIoB,IAAJ,GAAWC,OAAX;AAFb;AAFJ;AAOD;AAjEH;AAAA;AAAA,8BAmEYhE,IAnEZ,EAmEkB;AACd,UAAMiE,YAAY,GAAG,6BAAI,KAAKlB,KAAT,IAAgB/C,IAAhB,GAAsBkE,IAAtB,CAA2B,UAACC,CAAD,EAAIC,CAAJ,EAAU;AACxD;AACA,YAAMC,MAAM,GAAGF,CAAC,CAACxE,OAAF,GAAYwE,CAAC,CAACjE,KAAF,CAAQgB,MAAnC;AACA,YAAMoD,MAAM,GAAGF,CAAC,CAACzE,OAAF,GAAYyE,CAAC,CAAClE,KAAF,CAAQgB,MAAnC;AACA,YAAImD,MAAM,GAAGC,MAAb,EAAqB,OAAO,CAAP;AACrB,YAAID,MAAM,GAAGC,MAAb,EAAqB,OAAO,CAAC,CAAR,CALmC,CAMxD;;AACA,YAAIH,CAAC,CAACxE,OAAF,GAAYyE,CAAC,CAACzE,OAAlB,EAA2B,OAAO,CAAC,CAAR;AAC3B,YAAIwE,CAAC,CAACxE,OAAF,GAAYyE,CAAC,CAACzE,OAAlB,EAA2B,OAAO,CAAP;AAC3B,eAAO,CAAP;AACD,OAVoB,CAArB;AAWA,WAAKoD,KAAL,GAAakB,YAAb;AACD;AAhFH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAmFUM,8BAnFV,GAmF2BxD,qEAAU,CAAC,KAAKV,QAAL,EAAD,CAnFrC;AAAA;AAAA;AAAA,uBAqF4C,KAAKyC,OAAL,CAAazB,QAAb,CACpCkD,cADoC,CArF5C;;AAAA;AAAA;AAqFc3E,mBArFd,SAqFcA,GArFd;AAqFmBD,uBArFnB,SAqFmBA,OArFnB;AAqF4BO,qBArF5B,SAqF4BA,KArF5B;;AAwFM,oBAAIN,GAAJ,EAAS;AACP;AACQZ,2BAFD,GAEe,KAAKM,MAFpB,CAECN,SAFD,EAGP;;AAHO,0BAI4BiC,wEAAa,CAAC,KAAKZ,QAAL,EAAD,CAAb,IAAkC,EAJ9D,sBAICH,KAJD,EAIQU,UAJR,4BAIqB,EAJrB,gBAKP;;AACA,uBAAKX,IAAL,CAAU,MAAV,EAAkB;AAAEkD,uBAAG,EAAEnE,SAAP;AAAkBY,uBAAG,EAAHA,GAAlB;AAAuBD,2BAAO,EAAPA;AAAvB,mBAAlB,EANO,CAOP;;AACA,sBAAIiB,UAAU,CAACM,MAAf,EAAuB;AACrB,yBAAKjB,IAAL,CAAU,aAAV,EAAyB;AAAEC,2BAAK,EAAEU;AAAT,qBAAzB;AACD;AACF,iBAXD,MAWO;AACL;AACA,uBAAKwC,aAAL,CAAmB;AAAElD,yBAAK,EAALA,KAAF;AAASP,2BAAO,EAAPA;AAAT,mBAAnB,EAAuC,IAAvC;AACD,iBAtGP,CAuGM;;;AACA,qBAAK6E,YAAL,GAAoBxD,SAApB;AACA,qBAAKsB,YAAL;AAzGN;AAAA;;AAAA;AAAA;AAAA;AA2GM;AACA;AACA,qBAAKmC,cAAL;;AA7GN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qCAiHmB;AAAA;;AACf,UAAI,CAAC,KAAKD,YAAV,EAAwB;AACtB,aAAKA,YAAL,GAAoBhE,MAAM,CAACC,UAAP,CAAkB,YAAM;AAC1C,gBAAI,CAACiE,OAAL;AACD,SAFmB,EAEjB,IAFiB,CAApB;AAGD;AACF;AAvHH;AAAA;AAAA,oCAyHkB;AACd,UAAI,KAAKF,YAAT,EAAuB;AACrBhE,cAAM,CAACD,YAAP,CAAoB,KAAKiE,YAAzB;AACA,aAAKA,YAAL,GAAoBxD,SAApB;AACD;AACF;AA9HH;AAAA;AAAA,mCAgIiB;AACb,UAAI,KAAK+B,KAAL,CAAW7B,MAAX,GAAoB,CAAxB,EAA2B;AACzB,YAAIqD,cAAc,GAAGxD,qEAAU,CAAC,KAAKV,QAAL,EAAD,CAA/B;;AACA,eAAO,KAAK0C,KAAL,CAAW7B,MAAX,GAAoB,CAA3B,EAA8B;AAC5B,cAAMyD,KAAK,GAAG,KAAK5B,KAAL,CAAW,CAAX,CAAd;AACA,cAAM6B,YAAY,GAAGD,KAAK,CAAChF,OAA3B;AACA,cAAMkF,eAAe,GAAGF,KAAK,CAACzE,KAAN,CAAYgB,MAAZ,GAAqBqD,cAA7C;;AACA,cAAIK,YAAY,IAAIC,eAApB,EAAqC;AACnC;AACA,iBAAKC,aAAL;AACA,iBAAK/B,KAAL,CAAWgC,KAAX;AACA,iBAAKC,iBAAL,CAAuBL,KAAvB;AACAJ,0BAAc,GAAGK,YAAjB;AACD,WAND,MAMO;AACL,gBAAIA,YAAY,IAAIC,eAApB,EAAqC;AACnC;AACA,mBAAK9B,KAAL,CAAWgC,KAAX;AACD;;AACD,gBAAIH,YAAY,GAAGC,eAAnB,EAAoC;AAClC;AACA,mBAAKJ,cAAL;AACA;AACD;AACF;AACF;AACF;AACF;AA1JH;AAAA;AAAA,sCAkMoBzF,SAlMpB,EAkM+B2D,SAlM/B,EAkM0C;AAAA;;AACtC,UAAM5D,MAAM,GAAG,KAAKQ,aAAL,CAAmB0C,SAAnB,CAA6BjD,SAA7B,CAAf;AACA,UAAMuD,WAAW,GAAGzD,mEAAc,CAAC;AAAEC,cAAM,EAANA,MAAF;AAAUC,iBAAS,EAATA;AAAV,OAAD,CAAlC;AAEA,WAAKwD,YAAL,CAAkByC,GAAlB,CAAsBlG,MAAtB;AACEE,YAAI,EAAE,EADR;AAEEG,aAAK,EAAE,EAFT;AAGEF,cAAM,EAAE,EAHV;AAIEF,iBAAS,EAAEA,SAJb;AAKED,cAAM,EAAEA;AALV,SAMKwD,WANL;AAOEG,kBAAU,EAAEC;AAPd;AAUA,UAAMuC,MAAM,GAAG,CAAC,KAAK1C,YAAL,CAAkBC,GAAlB,CAAsB1D,MAAtB,CAAD,CAAf,CAdsC,CAgBtC;AACA;;AAEA,UAAMoG,GAAG,GAAG,IAAIpB,IAAJ,GAAWC,OAAX,EAAZ;AACA,UAAM1G,IAAI,GAAG8H,KAAK,CAACC,IAAN,CAAW,KAAK7C,YAAL,CAAkB8C,MAAlB,EAAX,EAAuCC,MAAvC,CACX,UAAAC,CAAC;AAAA,eAAI,CAACL,GAAG,GAAGK,CAAC,CAAC9C,UAAT,IAAuB,IAAvB,GAA8B,GAAlC;AAAA,OADU,CAAb;AAIApF,UAAI,CAACmI,OAAL,CAAa,UAAAD,CAAC;AAAA,eAAI,MAAI,CAAChD,YAAL,CAAkBkD,MAAlB,CAAyBF,CAAC,CAACzG,MAA3B,CAAJ;AAAA,OAAd;AACA,WAAKkB,IAAL,CAAU,UAAV,EAAsB;AAAEiF,cAAM,EAANA,MAAF;AAAU5H,YAAI,EAAJA;AAAV,OAAtB;AACD;AAED;;;;AA9NF;AAAA;AAAA,yBAiOOiE,GAjOP,EAiOYvB,IAjOZ,EAiOkB;AACd,WAAKP,YAAL,CAAkBQ,IAAlB,CAAuBsB,GAAvB,EAA4BvB,IAA5B;AACA,aAAO,IAAP;AACD;AAED;;;;AAtOF;AAAA;AAAA,uBAyOKuB,GAzOL,EAyOUC,OAzOV,EAyOmB;AACf,WAAK/B,YAAL,CAAkBgC,EAAlB,CAAqBF,GAArB,EAA0BC,OAA1B;AACA,aAAO,IAAP;AACD;AAED;;;;AA9OF;AAAA;AAAA,wBAiPMD,GAjPN,EAiPWC,OAjPX,EAiPoB;AAChB,WAAK/B,YAAL,CAAkBiC,GAAlB,CAAsBH,GAAtB,EAA2BC,OAA3B;AACA,aAAO,IAAP;AACD;AAED;;;;AAtPF;AAAA;AAAA,mCAyPiBD,GAzPjB,EAyPsB;AAClB,WAAK9B,YAAL,CAAkBkG,kBAAlB,CAAqCpE,GAArC;AACD;AA3PH;;AAAA;AAAA;AA8PeM,6EAAf,E;;;;;;;;ACtQA;AAAA;AAAA;AAAA;AAAA;AAA8H;AACQ;AACtI,iBAAiB,8HAAY;AAC7B;AACA;AACA;AACA,sQAAsQ,kBAAkB,kBAAkB,cAAc,wDAAwD,kBAAkB,kBAAkB,cAAc;AACla,CAAC;AACD,aAAa,4IAAM;AACJ,qE;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACTf;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA,IAAI+D,SAAJ;;AACA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAASC,MAAT,EAAiBC,QAAjB,EAA2B;AAC3C,MAAMC,GAAG,GAAGC,mBAAO,CAAC,MAAD,CAAP,CAA0BC,OAAtC;;AACAC,0DAAM,CACJ,2DAAC,uDAAD;AACE,QAAI,EAAEP,SADR;AAEE,eAAW,EAAE,qBAAAA,SAAS;AAAA,aAAIK,4BAAQ,YAAWL,SAAZ,EAAX;AAAA;AAFxB,KAIE,2DAAC,wDAAD;AAAc,UAAM,EAAEE;AAAtB,KACE,2DAAC,2DAAD,CAAU,QAAV;AAAmB,SAAK,EAAEC;AAA1B,KACE,2DAAC,GAAD;AAAK,YAAQ,EAAEA;AAAf,IADF,CADF,CAJF,CADI,EAWJK,QAAQ,CAACC,aAAT,CAAuB,oBAAvB,CAXI,CAAN;AAaD,CAfD,C,CAiBA;;;AACA,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAASC,MAAT,EAAiBC,WAAjB,EAA8B;AACrD,MAAMC,aAAa,GAAG,uBAAtB,CADqD,CACP;;AAC9C,SAAOA,aAAa,CAACC,IAAd,CAAmBH,MAAnB,IAA6BC,WAA7B,GAA2CD,MAAlD;AACD,CAHD;;AAKA,IAAMI,UAAU,GAAG,SAAbA,UAAa,GAAW;AAC5B,MAAMC,IAAI,GAAGR,QAAQ,CAACC,aAAT,CAAuB,oBAAvB,CAAb;AACA,SAAOO,IAAI,CAACC,OAAZ;AACD,CAHD;;AAKA,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAASD,OAAT,EAAkB;AACjC,MACEA,OAAO,IACPA,OAAO,CAACE,SADR,IAEAF,OAAO,CAACE,SAAR,CAAkB7F,MAAlB,GAA2B,CAF3B,IAGA2F,OAAO,CAACE,SAAR,CAAkB,CAAlB,KAAwB,GAJ1B,EAKE;AACA,WAAO;AAAEhB,cAAQ,EAAE,KAAZ;AAAmBiB,WAAK,EAAEH,OAAO,CAACE;AAAlC,KAAP;AACD,GAPD,MAOO;AACL,QAAME,QAAQ,GAAG,SAAXA,QAAW,GAAiC;AAAA,UAAhCC,GAAgC,uEAA1B,EAA0B;;AAAA;AAAA;AAAA,UAArBC,GAAqB;AAAA;AAAA,UAAhBC,GAAgB,uBAAV,IAAU;;AAChDF,SAAG,CAACC,GAAD,CAAH,GAAWC,GAAX;AACA,aAAOF,GAAP;AACD,KAHD;;AADK,gCAKiB1G,MAAM,CAAC6G,QAAP,CAAgBC,MAAhB,CACnBC,SADmB,CACT,CADS,EAEnBC,KAFmB,CAEb,GAFa,EAGnBzF,GAHmB,CAGf,UAAA0F,MAAM;AAAA,aAAIA,MAAM,CAACD,KAAP,CAAa,GAAb,CAAJ;AAAA,KAHS,EAInBE,MAJmB,CAIZT,QAJY,EAIF,EAJE,CALjB;AAAA,QAKGU,SALH,yBAKGA,SALH;;AAUL,WAAO;AAAE5B,cAAQ,EAAE,IAAZ;AAAkBiB,WAAK,EAAEW;AAAzB,KAAP;AACD;AACF,CApBD,C,CAsBA;;;AACAvB,QAAQ,CAACwB,gBAAT,CAA0B,kBAA1B,EAA8C,YAAM;AAClD,MAAM5H,IAAI,GAAG2G,UAAU,EAAvB;AAEA,MAAMkB,OAAO,GAAGvB,gBAAgB,CAC9BtG,IAAI,CAAC8H,YADyB,EAE9B7B,mBAAO,CAAC,MAAD,CAFuB,CAAhC;AAKA,MAAM8B,aAAa,GAAGzB,gBAAgB,CACpCtG,IAAI,CAACgI,iBAAL,IAA0B/B,mBAAO,CAAC,MAAD,CAAP,CAAoCgC,WAD1B,EAEpC,EAFoC,CAAtC;AAKA,MAAMC,OAAO,GAAG5B,gBAAgB,CAC9BtG,IAAI,CAACmI,WADyB,EAE9BlC,mBAAO,CAAC,MAAD,CAAP,CAAoChH,IAFN,CAAhC;AAKA,MAAMmJ,OAAO,GAAG9B,gBAAgB,CAC9BtG,IAAI,CAACqI,WADyB,EAE9BpC,mBAAO,CAAC,MAAD,CAAP,CAAoCqC,IAFN,CAAhC;AAKA,MAAMC,UAAU,GAAGjC,gBAAgB,CACjCtG,IAAI,CAACwI,cAD4B,EAEjCvC,mBAAO,CAAC,MAAD,CAAP,CAAoCtG,OAFH,CAAnC;AAKAiG,WAAS,GAAGU,gBAAgB,CAACtG,IAAI,CAACyI,UAAN,EAAkB,IAAlB,CAA5B;AAEA,MAAMC,QAAQ,GAAGlI,MAAM,CAAC6G,QAAP,GAAkB7G,MAAM,CAAC6G,QAAP,CAAgBqB,QAAlC,GAA6C,QAA9D;;AA9BkD,kBAgCtB5B,QAAQ,CAAC9G,IAAD,CAhCc;AAAA,MAgC1C+F,QAhC0C,aAgC1CA,QAhC0C;AAAA,MAgChCiB,KAhCgC,aAgChCA,KAhCgC,EAkClD;;;AACA,MAAMlB,MAAM,GAAG,IAAI6C,kDAAJ,CAAe;AAC5BC,OAAG,YAAKF,QAAL,eAAkB1I,IAAI,CAAC6I,UAAvB,CADyB;AAE5B7B,SAAK,EAAEA,KAFqB;AAG5B8B,UAAM,EAANA,uDAH4B;AAI5BC,eAAW,EAAE;AACXT,UAAI,EAAEF,OADK;AAEXzI,aAAO,EAAE4I;AAFE;AAJe,GAAf,CAAf;;AAUA,MAAI,CAACxC,QAAL,EAAe;AACb;AACA;AACAiD,QAAI,CAACC,GAAL,CAASC,IAAT,CAAc;AACZhB,aAAO,EAAEA,OADG;AAEZH,mBAAa,EAAEA,aAFH;AAGZoB,cAAQ,EAAEtB,OAHE;AAIZuB,UAAI,EAAExD,SAJM;AAKZyD,0BAAoB,EAAE,IALV;AAMZC,gBAAU,EAAExD,MANA;AAOZC,cAAQ,EAAEA;AAPE,KAAd;AASD;;AAEDF,WAAS,CAACC,MAAD,EAASC,QAAT,CAAT;AACD,CA5DD,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/DA;AAEA;AAEA;AACA;AAEA;AACA;AAEA;AAEA,IAAMwD,MAAM,GAAGC,8DAAU,CAAC,UAASpM,KAAT,EAAgB;AAAA,MAChC0I,MADgC,GACb1I,KADa,CAChC0I,MADgC;AAAA,MACxB2D,MADwB,GACbrM,KADa,CACxBqM,MADwB;AAExC,MAAMC,QAAQ,GAAGC,qDAAO,CACtB;AAAA,WAAMvM,KAAK,CAACsM,QAAN,IAAkBE,4EAAsB,CAAC9D,MAAD,CAA9C;AAAA,GADsB,EAEtB,CAAC1I,KAAK,CAACsM,QAAP,CAFsB,CAAxB,CAFwC,CAOxC;;AACA,MAAM7J,KAAK,GAAG4J,MAAd;AACA,MAAM1K,MAAM,GAAG2K,QAAf;AACA,MAAMJ,UAAU,GAAGxD,MAAnB,CAVwC,CAYxC;;AAZwC,kBAaV+D,sDAAQ,CAAC,IAAD,CAbE;AAAA;AAAA,MAajCC,OAbiC;AAAA,MAaxBC,UAbwB;;AAAA,mBAclBF,sDAAQ,CAAC7I,SAAD,CAdU;AAAA;AAAA,MAcjCpB,GAdiC;AAAA,MAc5BoK,MAd4B;;AAAA,mBAedH,sDAAQ,CAAC7I,SAAD,CAfM;AAAA;AAAA,MAejC7C,KAfiC;AAAA,MAe1B8L,QAf0B,kBAiBxC;;;AACA,MAAM1K,aAAa,GAAGoK,qDAAO,CAC3B,YAAM;AACJ,WAAO,IAAIO,gEAAJ,CAAkB;AAAEnL,YAAM,EAANA,MAAF;AAAU2K,cAAQ,EAARA,QAAV;AAAoBJ,gBAAU,EAAVA;AAApB,KAAlB,CAAP;AACD,GAH0B,EAI3B,CAACG,MAAD,CAJ2B,CAA7B;AAMA,MAAMU,UAAU,GAAGvK,GAAG,IAAIA,GAAG,CAACD,OAA9B,CAxBwC,CAyBxC;;AACA,MAAMvB,cAAc,GAAGuL,qDAAO,CAC5B,YAAM;AACJ;AACA,QAAIQ,UAAU,KAAKnJ,SAAnB,EAA8B;AAC5B;AACA,UAAMoJ,QAAQ,GAAG,IAAIvI,4DAAJ,CACf;AAAElC,eAAO,EAAEC,GAAG,CAACD,OAAf;AAAwBE,aAAK,EAALA;AAAxB,OADe,EAEfN,aAFe,CAAjB;AAIA,aAAO;AACL8K,uBAAe,EAAE,IADZ;AAELD,gBAAQ,EAAEE,OAAO,CAACC,OAAR,CAAgBH,QAAhB,CAFL;AAGLI,2BAAmB,EAAE;AAAA,iBAAMxJ,SAAN;AAAA,SAHhB;AAILyJ,oCAA4B,EAAE,KAJzB;AAKL1L,cAAM,EAAEQ,aAAa,CAACsD,YAAd;AALH,OAAP;AAOD,KAbD,MAaO;AACL,aAAO,IAAP;AACD;AACF,GAnB2B,EAoB5B,CAAC4G,MAAD,EAASU,UAAT,EAAqBT,QAArB,EAA+BnK,aAA/B,CApB4B,CAA9B,CA1BwC,CAgDxC;AAEA;;AACAZ,yDAAS,CACP,YAAM;AACJ,QAAM+L,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA,6EAAG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEP,oBAAI,CAACZ,OAAL,EAAc;AACZC,4BAAU,CAAC,IAAD,CAAV;AACD;;AAJM;AAAA,uBAKWxK,aAAa,CAACoL,MAAd,CAAqBlB,MAArB,CALX;;AAAA;AAKD7J,oBALC;AAMPqK,wBAAQ,CAACrK,IAAG,CAACzB,KAAJ,IAAa,EAAd,CAAR;AACA6L,sBAAM,CAACpK,IAAD,CAAN;AAPO;AAAA;;AAAA;AAAA;AAAA;AASPqK,wBAAQ,CAAC,KAAD,CAAR;AACAD,sBAAM,CAAC,KAAD,CAAN;;AAVO;AAYTD,0BAAU,CAAC,KAAD,CAAV;;AAZS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAH;;AAAA,sBAAFW,EAAE;AAAA;AAAA;AAAA,OAAR;;AAcAA,MAAE;AACH,GAjBM,EAkBP,CAACjB,MAAD,CAlBO,CAAT,CAnDwC,CAwExC;;AACA,MAAMxL,eAAe,GAAGQ,yDAAW,CAAC;AAAA,WAAM,IAAN;AAAA,GAAD,EAAa,CAACgL,MAAD,CAAb,CAAnC;AACA,MAAMmB,kBAAkB,GAAGnM,yDAAW,CACpC,UAAAC,CAAC,EAAI;AACH,QAAMmM,QAAQ,GAAGnM,CAAC,CAAChB,MAAF,CAASoN,KAA1B;AACA,QAAMC,aAAa,GAAGF,QAAtB;;AACA,QAAI1M,KAAK,IAAI4M,aAAb,EAA4B;AAC1Bd,cAAQ,CAACc,aAAD,CAAR;AACAxL,mBAAa,CAAC0K,QAAd,CAAuBR,MAAvB,EAA+BsB,aAA/B;AACD;AACF,GARmC,EASpC,CAACtB,MAAD,EAASQ,QAAT,EAAmB1K,aAAnB,CAToC,CAAtC;AAWA,MAAMyL,mBAAmB,GAAGvM,yDAAW,CACrC,UAAAsM,aAAa,EAAI;AACf,QAAI5M,KAAK,IAAI4M,aAAb,EAA4B;AAC1Bd,cAAQ,CAACc,aAAD,CAAR;AACD;AACF,GALoC,EAMrC,CAACtB,MAAD,EAASQ,QAAT,CANqC,CAAvC;AAQAN,uDAAO,CACL,YAAM;AACJpK,iBAAa,CAAC0L,cAAd,CAA6BxB,MAA7B,EAAqCuB,mBAArC;AACD,GAHI,EAIL,CAACA,mBAAD,EAAsBzL,aAAtB,CAJK,CAAP,CA7FwC,CAmGxC;;AACAZ,yDAAS,CAAC,YAAM;AACd,QAAI,CAACmL,OAAD,IAAY,CAAClK,GAAjB,EAAsB;AACpB;AACAuC,aAAO,CAACC,IAAR,+BAAoCqH,MAApC;AACArM,WAAK,CAAC8N,OAAN,CAAcC,IAAd;AACD;AACF,GANQ,CAAT;AAQA,MAAM9M,SAAS,GAAGsL,qDAAO,CACvB,YAAM;AACJ,QAAIvM,KAAK,CAACiB,SAAN,KAAoB2C,SAAxB,EAAmC;AACjC,aAAO5D,KAAK,CAACiB,SAAb;AACD,KAFD,MAEO,IAAIuB,GAAJ,EAAS;AACd,aAAOwL,yEAAmB,CAACtF,MAAD,EAASlG,GAAG,CAACyL,IAAb,CAA1B;AACD,KAFM,MAEA;AACL,aAAOjO,KAAK,CAACiB,SAAb;AACD;AACF,GATsB,EAUvB,CAACjB,KAAK,CAACiB,SAAP,EAAkBuB,GAAlB,CAVuB,CAAzB,CA5GwC,CAyHxC;;AACA,MAAIkK,OAAO,IAAI,CAAClK,GAAhB,EAAqB;AACnB,WAAO,2DAAC,uDAAD,OAAP;AACD,GAFD,MAEO;AACL,WACE,2DAAC,oDAAD;AACE,mBAAa,EAAEgL,kBADjB;AAEE,qBAAe,EAAE3M,eAFnB;AAGE,oBAAc,EAAEG,cAHlB;AAIE,kBAAY,EAAE,kBAJhB;AAKE,kBAAY,oBAAOwB,GAAG,CAACA,GAAX;AAAgBD,eAAO,EAAEC,GAAG,CAACD;AAA7B,QALd;AAME,WAAK,EAAExB,KAAK,IAAIA,KAAK,CAAC+C,MAAN,GAAe,CAAxB,GAA4B/C,KAA5B,GAAoC6C,SAN7C;AAOE,eAAS,EAAE3C;AAPb,MADF;AAWD;AACF,CAzIwB,CAAzB;AA2IekL,qEAAf,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvJA;AAEA;AAEA;AAEA;AAEA;AACA;;IAEM+B,G;;;;;AACJ,eAAYlO,KAAZ,EAAmBmO,OAAnB,EAA4B;AAAA;;AAAA;;AAC1B,6EAAMnO,KAAN,EAAamO,OAAb,GAD0B,CAE1B;;AAF0B;AAAA;AAAA;AAAA;AAAA,2EAQd;AAAA;;AAAA;AAAA;AAAA;AAAA;AACZ,oBAAKC,QAAL,CAAc,YAAM;AAClB;AACD,eAFD;;AAGgBlC,wBAJJ,GAImB,MAAKlM,KAJxB,CAIJ0I,MAJI;AAAA;AAAA,qBAKgBwD,UAAU,CACnCmC,cADyB,GAEzBC,SAFyB,CAEf,MAFe,EAEP,QAFO,EAEG;AAC3B1L,oBAAI,EAAE;AACJ6D,sBAAI,EAAE,yBADF;AAEJ8H,4BAAU,EAAE;AACVxN,yBAAK,EAAE,EADG;AAEV2K,0BAAM,EAAE8C,gEAAaA;AAFX;AAFR;AADqB,eAFH,CALhB;;AAAA;AAAA;AAKEhM,iBALF,SAKJI,IALI;;AAgBZ,oBAAKwL,QAAL,CAAc,YAAM;AAClB;AACD,eAFD;;AAIAhL,oBAAM,CAAC6G,QAAP,CAAgBwE,IAAhB,GAAuBC,gFAA6B,CAAClM,GAAD,CAApD;;AApBY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KARc;;AAG1B,UAAKe,KAAL,GAAa;AACXoL,eAAS,EAAE;AADA,KAAb;AAH0B;AAM3B;;;;6BAyBQ;AAAA,UACCA,SADD,GACe,KAAKpL,KADpB,CACCoL,SADD;AAEP,aACE,wEACE,2DAAC,4DAAD;AACE,eAAO,EAAE,KAAKC,WADhB;AAEE,YAAI,EAAC,QAFP;AAGE,YAAI,EAAED,SAHR;AAIE,YAAI,EAAC,MAJP;AAKE,aAAK,EAAC,kBALR;AAME,iBAAS,EAAC;AANZ,QADF,CADF;AAYD;;;;EA9CeE,+C,GAiDlB;;;AACezC,6HAAU,CAAC0C,mEAAU,CAACZ,GAAD,CAAX,CAAzB,E;;;;;;;;AC7DA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AAEA;AACA;AAEe,SAASa,aAAT,GAAyB;AACtC,MAAM7O,IAAI,GACR,2DAAC,4DAAD;AACE,QAAI,EAAC,MADP;AAEE,OAAG,EAAE8O,qDAFP;AAGE,MAAE,EAAC,GAHL;AAIE,aAAS,EAAC,cAJZ;AAKE,SAAK,EAAC,sBALR;AAME,UAAM;AANR,IADF;AAUA,SACE,wEACE,2DAAC,oDAAD;AAAY,QAAI,EAAE9O;AAAlB,IADF,EAEE,2DAAC,6DAAD;AAAS,QAAI,EAAC,SAAd;AAAwB,UAAM;AAA9B,IAFF,CADF;AAMD,C;;;;;;;AC1BD,iC;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAEA,IAAM+O,QAAQ,GAAGC,4CAAK,CAACC,aAAN,CAAoB,KAApB,CAAjB;AACeF,uEAAf,E;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;CAGA;;;;;;;;;;ACJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AAEA;;AAEA,IAAMG,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAM,CAAE,CAAjC;;AAEA,IAAMC,IAAI,GAAG,SAAPA,IAAO,CAAArP,KAAK;AAAA,SAChB;AAAK,aAAS,EAAC;AAAf,KACE,2DAAC,0DAAD;AAAM,QAAI,EAAEsP,sEAAZ;AAAkB,SAAK,EAAE,EAAzB;AAA6B,UAAM,EAAE,EAArC;AAAyC,aAAS,EAAC;AAAnD,IADF,EAEE,2DAAC,qDAAD;AAAM,MAAE,eAAQtP,KAAK,CAACuP,IAAN,CAAWC,EAAnB,CAAR;AAAiC,aAAS,EAAC;AAA3C,KACE,2DAAC,kEAAD;AACE,eAAW,EAAEJ,gBAAgB,CAACpP,KAAK,CAACuP,IAAP,CAD/B;AAEE,iBAAa,EAAC;AAFhB,IADF,CAFF,CADgB;AAAA,CAAlB;;AAYA,IAAME,GAAG,GAAG,SAANA,GAAM,CAAAzP,KAAK,EAAI;AACnB,MAAM0P,SAAS,GAAG,IAAI/I,IAAJ,CAAS3G,KAAK,CAACuP,IAAN,CAAWI,YAAX,CAAwBD,SAAjC,CAAlB;AACA,MAAME,OAAO,GAAG;AAAEC,OAAG,EAAE,SAAP;AAAkBC,SAAK,EAAE,MAAzB;AAAiCC,QAAI,EAAE;AAAvC,GAAhB;AACA,MAAMC,iBAAiB,GAAGN,SAAS,CAACO,kBAAV,CAA6BrM,SAA7B,EAAwCgM,OAAxC,CAA1B;AACA,SACE;AAAI,aAAS,EAAC;AAAd,KACE;AAAI,aAAS,EAAC;AAAd,KACE,2DAAC,IAAD,EAAU5P,KAAV,CADF,CADF,EAIE;AAAI,aAAS,EAAC;AAAd,KACE;AAAM,YAAQ,EAAEA,KAAK,CAACuP,IAAN,CAAWI,YAAX,CAAwBD;AAAxC,KACGM,iBADH,CADF,CAJF,EASE;AAAI,aAAS,EAAC;AAAd,cATF,EAUE;AAAI,aAAS,EAAC;AAAd,KACE,2DAAC,4DAAD;AACE,SAAK,EAAC,QADR;AAEE,aAAS,EAAC,QAFZ;AAGE,QAAI,EAAE,2DAAC,0DAAD;AAAM,UAAI,EAAC,MAAX;AAAkB,WAAK,EAAC,UAAxB;AAAmC,WAAK,EAAC,IAAzC;AAA8C,YAAM,EAAC;AAArD,MAHR;AAIE,YAAQ,MAJV;AAKE,SAAK,EAAC;AALR,IADF,CAVF,CADF;AAsBD,CA1BD;;AA4BA,IAAME,IAAI,GAAG,SAAPA,IAAO,CAAAlQ,KAAK,EAAI;AAAA,MACZmQ,KADY,GACFnQ,KADE,CACZmQ,KADY;AAEpB,SAAO,CAACA,KAAD,IAAU,CAACA,KAAK,CAACrM,MAAjB,GAA0B,IAA1B,GACL;AAAO,aAAS,EAAC;AAAjB,KACE;AAAO,aAAS,EAAC;AAAjB,KACE;AAAI,aAAS,EAAC;AAAd,KACE;AAAI,aAAS,EAAC;AAAd,WADF,EAEE;AAAI,aAAS,EAAC;AAAd,kCAFF,EAGE;AAAI,aAAS,EAAC;AAAd,gBAHF,EAIE;AAAI,aAAS,EAAC;AAAd,IAJF,CADF,CADF,EASE,0EACGqM,KAAK,CAACxL,GAAN,CAAU,UAAA4K,IAAI;AAAA,WACb,2DAAC,GAAD;AAAK,SAAG,EAAEA,IAAI,CAACa,GAAf;AAAoB,UAAI,EAAEb;AAA1B,MADa;AAAA,GAAd,CADH,CATF,CADF;AAiBD,CAnBD;;AAqBA,IAAMc,UAAU,GAAG,SAAbA,UAAa,GAAM;AACvB,SACE,wHACE,2DAAC,wDAAD;AACE,QAAI,EAAE,2DAAC,4DAAD;AAAW,SAAG,EAAC;AAAf,mBADR;AAEE,SAAK,EAAE,2DAAC,4CAAD;AAFT,IADF,CADF;AAQD,CATD;;AAWA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAAAtQ,KAAK,EAAI;AAAA,qBACCA,KAAK,CAACmQ,KADP;AAAA,MACrBvN,IADqB,gBACrBA,IADqB;AAAA,MACf2N,WADe,gBACfA,WADe,EAE7B;;AACA,MAAMC,SAAS,GAAGD,WAAW,KAAK,SAAhB,IAA6BA,WAAW,KAAK,SAA/D;AACA,SACE;AAAK,aAAS,EAAC;AAAf,KACGC,SAAS,GACR,2DAAC,6DAAD;AAAS,QAAI,EAAC,SAAd;AAAwB,UAAM;AAA9B,IADQ,GAGR,wEACE,2DAAC,UAAD,OADF,EAEE,2DAAC,IAAD;AAAM,SAAK,EAAE5N;AAAb,IAFF,CAJJ,CADF;AAYD,CAhBD;;AAkBeyN,yEAAf,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5GA;CAIA;;AAEO,IAAMvD,aAAb;AAAA;AAAA;AACE,yBAAY5K,MAAZ,EAAoB;AAAA;;AAAA,QACVP,MADU,GACqBO,MADrB,CACVP,MADU;AAAA,QACFuK,UADE,GACqBhK,MADrB,CACFgK,UADE;AAAA,QACUR,MADV,GACqBxJ,MADrB,CACUwJ,MADV;AAElB,QAAM3D,GAAG,GAAG,IAAIpB,IAAJ,EAAZ;AACA,QAAM8J,aAAa,GACjB1I,GAAG,CAACnB,OAAJ,KAAgB,GAAhB,GAAsBmB,GAAG,CAAC2I,eAAJ,EAAtB,GAA8C,GAA9C,GAAoDC,IAAI,CAACC,MAAL,EADtD;AAEA,SAAKhP,SAAL,GAAiBD,MAAM,GAAG,GAAT,GAAe8O,aAAhC;AACA,SAAK9O,MAAL,GAAc,KAAKkD,SAAL,CAAelD,MAAf,CAAd;AACA,SAAKuK,UAAL,GAAkBA,UAAlB;AACA,SAAK2E,WAAL,GAAmB3E,UAAU,CAACmC,cAAX,EAAnB;AACA,SAAK3C,MAAL,GAAcA,MAAd;AACA,SAAKoF,eAAL,GAAuB,KAAKA,eAAL,CAAqBC,IAArB,CAA0B,IAA1B,CAAvB;AACA,SAAKC,QAAL,GAAgB,IAAIC,oDAAJ,CAAiB;AAAEvI,YAAM,EAAEwD;AAAV,KAAjB,CAAhB;AACA,SAAKgF,cAAL;AACD;;AAdH;AAAA;AAAA,qCAgBmB;AACf,WAAKC,SAAL,GAAiB,EAAjB;AACD;AAlBH;AAAA;AAAA,gCAoBc1K,IApBd,EAoBoB+I,EApBpB,EAoBwB4B,QApBxB,EAoBkC;AAC9B,WAAKD,SAAL,CAAe1K,IAAf,IAAuB,KAAK0K,SAAL,CAAe1K,IAAf,KAAwB,EAA/C;AACA,WAAK0K,SAAL,CAAe1K,IAAf,EAAqB+I,EAArB,IAA2B4B,QAA3B;AACD;AAvBH;AAAA;AAAA,8BAyBYxP,SAzBZ,EAyBuB;AACnB,aAAOA,SAAS,GAAGA,SAAS,CAACyP,KAAV,CAAgB,OAAhB,EAAyB,CAAzB,CAAH,GAAiC,KAAK1P,MAAtD;AACD;AA3BH;AAAA;AAAA,mCA6BiB;AACb,aAAO,KAAKC,SAAZ;AACD;AA/BH;AAAA;AAAA,4BAiCU;AACN,WAAKoP,QAAL,CAAcM,cAAd;AACA,WAAKJ,cAAL;AACD;AApCH;AAAA;AAAA,mCAsCiB;AACb,aAAO,IAAIvK,IAAJ,GAAW4K,WAAX,EAAP;AACD;AAxCH;AAAA;AAAA,yBA0CO/B,EA1CP,EA0CWgC,GA1CX,EA0CgB;AACZ,aAAOhC,EAAE,GAAIgC,GAAG,oBAAahC,EAAb,cAAmBgC,GAAnB,qBAAqChC,EAArC,CAAP,GAAoD,QAA7D;AACD;AA5CH;AAAA;AAAA,kCA8CgB5M,IA9ChB,EA8CsB;AAClB;AAAS6O,iBAAS,EAAE7O,IAAI,CAAChB,SAAL,IAAkB,KAAKA;AAA3C,SAAyDgB,IAAzD;AACD;AAhDH;AAAA;AAAA,kCAkDgBA,IAlDhB,EAkDsB;AAClB;AACEhB,iBAAS,EAAEgB,IAAI,CAAC6O,SADlB;AAEE9P,cAAM,EAAE,KAAKkD,SAAL,CAAejC,IAAI,CAAC6O,SAApB;AAFV,SAGK7O,IAHL;AAKD;AAxDH;AAAA;AAAA;AAAA;AAAA;AAAA,8FA0De7B,KA1Df,EA0DsB2K,MA1DtB;AAAA;AAAA;AAAA;AAAA;AAAA;AA2DUlJ,mBA3DV,GA2DgB;AACVI,sBAAI,EAAE;AACJ6D,wBAAI,EAAE,yBADF;AAEJ8H,8BAAU,EAAE;AACVxN,2BAAK,EAAEA,KAAK,IAAI,KAAKD,YAAL,EADN;AAEV4K,4BAAM,EAAEA,MAAM,IAAI,KAAKA,MAAf,IAAyBgG,qDAAaA;AAFpC;AAFR;AADI,iBA3DhB;AAAA,iDAoEW,KAAKb,WAAL,CAAiBvC,SAAjB,CAA2B,MAA3B,EAAmC,KAAKqD,IAAL,EAAnC,EAAgDnP,GAAhD,CApEX;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+FAuEiBC,KAvEjB,EAuEwB1B,KAvExB;AAAA;AAAA;AAAA;AAAA;AAAA;AAwEU6Q,wBAxEV,GAwEqB;AACfhP,sBAAI,EAAE;AACJ6D,wBAAI,EAAE,yBADF;AAEJ+I,sBAAE,EAAE/M,KAFA;AAGJ8L,8BAAU,EAAE,KAAKsD,aAAL,CAAmB;AAAE9Q,2BAAK,EAAEA;AAAT,qBAAnB;AAHR;AADS,iBAxErB;AAAA;AAAA,uBA+EU,KAAK8P,WAAL,CAAiBvC,SAAjB,CAA2B,KAA3B,EAAkC,KAAKqD,IAAL,CAAUlP,KAAV,EAAiB,OAAjB,CAAlC,EAA6DmP,QAA7D,CA/EV;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oCAkFkBpP,GAlFlB,EAkFuB;AACnB,UAAMgN,EAAE,GAAGhN,GAAG,CAACgN,EAAJ,IAAUhN,GAAG,CAAC4N,GAAzB;AACA,UAAM3J,IAAI,GAAGjE,GAAG,CAACsP,OAAjB;;AACA,UAAI,KAAKX,SAAL,CAAe1K,IAAf,KAAwB,KAAK0K,SAAL,CAAe1K,IAAf,EAAqB+I,EAArB,CAA5B,EAAsD;AACpD,eAAO,KAAK2B,SAAL,CAAe1K,IAAf,EAAqB+I,EAArB,EAAyBhN,GAAzB,CAAP;AACD,OAFD,MAEO;AACL;AACAuC,eAAO,CAACC,IAAR,CAAa,mBAAb,EAAkCyB,IAAlC,EAAwC+I,EAAxC,EAA4C,KAAK2B,SAAjD;AACD;AACF;AA3FH;AAAA;AAAA;AAAA;AAAA;AAAA,+FA6Fa1O,KA7Fb;AAAA;AAAA;AAAA;AAAA;AAAA;AA8FUsP,iCA9FV,GA8F8B,SAApBA,iBAAoB,CAASvP,GAAT,EAAc;AACtC,sBAAIA,GAAG,CAACgN,EAAJ,IAAU/M,KAAd,EAAqB;AACnB,2BAAO,KAAKqO,eAAL,CAAqBrO,KAArB,CAAP;AACD,mBAFD,MAEO;AACL,2BAAOmB,SAAP;AACD;AACF,iBApGL;;AAAA;AAAA,uBAqGUsJ,OAAO,CAAC8E,GAAR,CAAY,CAChB,KAAKhB,QAAL,CAAciB,SAAd,CACE,SADF,EAEE,sBAFF,EAGEF,iBAHF,CADgB,EAMhB,KAAKf,QAAL,CAAciB,SAAd,CACE,SADF,EAEE,sBAFF,EAGExP,KAHF,EAIE,KAAKqO,eAJP,CANgB,EAYhB,KAAKE,QAAL,CAAciB,SAAd,CACE,SADF,EAEE,sBAFF,EAGExP,KAHF,EAIE,KAAKqO,eAJP,CAZgB,CAAZ,CArGV;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+FA0HuBrO,KA1HvB,EA0H8B2O,QA1H9B;AAAA;;AAAA;AAAA;AAAA;AAAA;AA2HI,qBAAKc,WAAL,CAAiB,qBAAjB,EAAwCzP,KAAxC,EAA+C,UAAAG,IAAI;AAAA,yBACjDwO,QAAQ,CAAC,KAAI,CAACe,aAAL,CAAmBvP,IAAnB,CAAD,CADyC;AAAA,iBAAnD;;AA3HJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+FAgI6BH,KAhI7B,EAgIoC2O,QAhIpC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAiII,qBAAKc,WAAL,CAAiB,4BAAjB,EAA+CzP,KAA/C,EAAsD,UAAAG,IAAI;AAAA,yBACxDwO,QAAQ,CAAC,MAAI,CAACe,aAAL,CAAmBvP,IAAnB,CAAD,CADgD;AAAA,iBAA1D;;AAjIJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+FAsIuBH,KAtIvB,EAsI8B2O,QAtI9B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAuII,qBAAKc,WAAL,CAAiB,yBAAjB,EAA4CzP,KAA5C,EAAmD,UAAAD,GAAG,EAAI;AACxD,yBAAO,CAACA,GAAG,CAACiP,SAAL,IAAkBjP,GAAG,CAACiP,SAAJ,IAAiB,MAAI,CAAC7P,SAAxC,GACHwP,QAAQ,CAAC5O,GAAG,CAACzB,KAAL,CADL,GAEH,IAFJ;AAGD,iBAJD;;AAvIJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+FA8Ie0B,KA9If;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBA+IsB,KAAKoO,WAAL,CAAiBvC,SAAjB,CAA2B,KAA3B,EAAkC,KAAKqD,IAAL,CAAUlP,KAAV,CAAlC,CA/ItB;;AAAA;AA+IU2P,mBA/IV;AAAA,kDAgJW;AACL5P,qBAAG,EAAE4P,GAAG,CAACxP,IAAJ,CAAS2L,UAAT,CAAoB8D,QAApB,CAA6BC,OAD7B;AAEL/P,yBAAO,EAAE6P,GAAG,CAACxP,IAAJ,CAAS2L,UAAT,CAAoB8D,QAApB,CAA6B9P,OAFjC;AAGLxB,uBAAK,EAAEqR,GAAG,CAACxP,IAAJ,CAAS2L,UAAT,CAAoB8D,QAApB,CAA6BtR,KAH/B;AAILkN,sBAAI,EAAEmE,GAAG,CAACxP;AAJL,iBAhJX;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+FAwJkBH,KAxJlB,EAwJyBF,OAxJzB,EAwJkCO,KAxJlC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAyJU8M,uBAzJV,GAyJoB;AAAE2C,yBAAO,EAAE;AAAE,gCAAYhQ;AAAd;AAAX,iBAzJpB;AA0JUiQ,wBA1JV,GA0JqB;AACf5P,sBAAI,EAAEE,KAAK,CAAC6B,GAAN,CAAU,UAAAC,IAAI;AAAA,2BAAK;AACvB6B,0BAAI,EAAE,qBADiB;AAEvB8H,gCAAU,EAAE,MAAI,CAACsD,aAAL,CAAmBjN,IAAI,CAAC6N,MAAL,EAAnB;AAFW,qBAAL;AAAA,mBAAd;AADS,iBA1JrB,EAgKI;AACA;;AAjKJ;AAAA,uBAkKU,KAAK5B,WAAL,CAAiBvC,SAAjB,CACJ,OADI,EAEJ,KAAKqD,IAAL,CAAUlP,KAAV,CAFI,EAGJ+P,QAHI,EAIJ5C,OAJI,CAlKV;;AAAA;AAAA,kDAwKW,IAxKX;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+FA2KiBnN,KA3KjB,EA2KwBF,OA3KxB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBA6KwB,KAAKsO,WAAL,CAAiBvC,SAAjB,CAChB,KADgB,YAEb,KAAKqD,IAAL,CAAUlP,KAAV,EAAiB,OAAjB,CAFa,sBAEwBF,OAFxB,EA7KxB;;AAAA;AA6KY6P,mBA7KZ;;AAAA,sBAiLUA,GAAG,CAACxP,IAAJ,CAASkB,MAAT,IAAmB,CAjL7B;AAAA;AAAA;AAAA;;AAAA,kDAkLe;AAAEhB,uBAAK,EAAE,EAAT;AAAaP,yBAAO,EAAPA;AAAb,iBAlLf;;AAAA;AAAA,kDAoLe;AACLA,yBAAO,EAAE6P,GAAG,CAACxP,IAAJ,CAASwP,GAAG,CAACxP,IAAJ,CAASkB,MAAT,GAAkB,CAA3B,EAA8BvB,OADlC;AAELO,uBAAK,EAAEsP,GAAG,CAACxP,IAAJ,CAAS+B,GAAT,CAAa,UAAAC,IAAI;AAAA,6CACnBA,IADmB;AAEtB2J,gCAAU,EAAE,MAAI,CAACsD,aAAL,CAAmBjN,IAAI,CAAC2J,UAAxB;AAFU;AAAA,mBAAjB;AAFF,iBApLf;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AA6LYvK,wBA7LZ,GA6LuB,aAAIA,QA7L3B;AA8LYpB,oBA9LZ,GA8LmB,aAAI8P,MAAJ,IAAc,aAAIA,MAAJ,CAAW9P,IA9L5C;AA+LY+P,oBA/LZ,GA+LmB/P,IAAI,IAAIA,IAAI,CAAC2L,UAAb,IAA2B3L,IAAI,CAAC2L,UAAL,CAAgB8D,QA/L9D;AAgMY7P,mBAhMZ,GAgMkBmQ,IAAI,IAAIA,IAAI,CAACL,OAhM/B;AAiMYM,mBAjMZ,GAiMkBD,IAAI,IAAIA,IAAI,CAACpQ,OAjM/B;;AAAA,sBAkMUyB,QAAQ,CAAC6O,MAAT,IAAmB,GAAnB,IAA0BrQ,GAA1B,IAAiCoQ,GAlM3C;AAAA;AAAA;AAAA;;AAmMQ;AACA;AACME,kBArMd,GAqMmB,yBArMnB;;AAsMQ,oBAAI,KAAK3B,SAAL,CAAe2B,EAAf,KAAsB,KAAK3B,SAAL,CAAe2B,EAAf,EAAmBtQ,GAAG,CAACgN,EAAJ,IAAUhN,GAAG,CAAC4N,GAAjC,CAA1B,EAAiE;AAC/D,uBAAKe,SAAL,CAAe2B,EAAf,EAAmBtQ,GAAG,CAACgN,EAAJ,IAAUhN,GAAG,CAAC4N,GAAjC,EAAsC5N,GAAtC;AACD;;AAxMT,kDAyMe;AACLA,qBAAG,EAAEA,GADA;AAELD,yBAAO,EAAEqQ;AAFJ,iBAzMf;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gGAmNwBnQ,KAnNxB,EAmN+BG,IAnN/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAoNUmQ,8BApNV,GAoN2B;AACrBnQ,sBAAI,EAAE;AACJ6D,wBAAI,EAAE,4BADF;AAEJ+I,sBAAE,EAAE/M,KAFA;AAGJ8L,8BAAU,EAAE,KAAKsD,aAAL,CAAmBjP,IAAnB;AAHR;AADe,iBApN3B;AAAA,mDA2NW,KAAKiO,WAAL,CAAiBvC,SAAjB,CACL,KADK,EAEL,KAAKqD,IAAL,CAAUlP,KAAV,EAAiB,aAAjB,CAFK,EAGLsQ,cAHK,CA3NX;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAkOejG,4EAAf,E;;;;;;;;ACxOA;AAAA;AAAA;AAAA;AAAA;CAEA;AACA;AACA;AACA;AACA;;AAEA,IAAMkG,KAAK,GAAG,CACZ,CACE,KADF,EAEE;AACEV,SAAO,EAAE,UADX;AAEEW,OAAK,EAAE;AAFT,CAFF,CADY,EAQZ,CACE,WADF,EAEE;AACEX,SAAO,EAAE,SADX;AAEEY,OAAK,EAAE,OAFT;AAGED,OAAK,EACH,sEAJJ;AAKEE,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ;AALZ,CAFF,CARY,EAsBZ,CACE,MADF,EAEE;AACEF,OAAK,EAAE;AADT,CAFF,CAtBY,EA4BZ,CACE,YADF,EAEE;AACEA,OAAK,EAAE,OADT;AAEEZ,SAAO,EAAE,WAFX;AAGEa,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ;AAHZ,CAFF,CA5BY,EAwCZ,CACE,aADF,EAEE;AACEF,OAAK,EAAE,OADT;AAEEZ,SAAO,EAAE,WAFX;AAGEa,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ;AAHZ,CAFF,CAxCY,EAoDZ,CACE,UADF,EAEE;AACEd,SAAO,EAAE,uDADX;AAEEe,UAAQ,EAAE,IAFZ;AAGEF,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ;AAHZ,CAFF,CApDY,EAgEZ,CACE,SADF,EAEE;AACEE,OAAK,EAAE;AACLC,SAAK,EAAE;AACLzK,aAAO,EAAE;AADJ;AADF,GADT;AAMEwJ,SAAO,EAAE,SANX;AAOEY,OAAK,EAAE,OAPT;AAQEG,UAAQ,EAAE,IARZ;AASEF,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE,IADP;AAEEE,SAAK,EAAE;AACLC,WAAK,EAAE;AADF;AAFT,GADQ,EAOR;AACEH,OAAG,EAAE,IADP;AAEEE,SAAK,EAAE;AACLC,WAAK,EAAE;AADF;AAFT,GAPQ,EAaR;AACEH,OAAG,EAAE,IADP;AAEEE,SAAK,EAAE;AACLC,WAAK,EAAE;AADF;AAFT,GAbQ,EAmBR;AACEH,OAAG,EAAE,IADP;AAEEE,SAAK,EAAE;AACLC,WAAK,EAAE;AADF;AAFT,GAnBQ,EAyBR;AACEH,OAAG,EAAE,IADP;AAEEE,SAAK,EAAE;AACLC,WAAK,EAAE;AADF;AAFT,GAzBQ,EA+BR;AACEH,OAAG,EAAE,IADP;AAEEE,SAAK,EAAE;AACLC,WAAK,EAAE;AADF;AAFT,GA/BQ;AATZ,CAFF,CAhEY,EAmHZ,CACE,YADF,EAEE;AACEjB,SAAO,EAAE,YADX;AAEEY,OAAK,EAAE,OAFT;AAGEG,UAAQ,EAAE,IAHZ;AAIEG,YAAU,EAAE,KAJd;AAKEL,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ;AALZ,CAFF,CAnHY,EAiIZ,CACE,MADF,EAEE;AACEF,OAAK,EAAE,OADT;AAEEC,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ;AAFZ,CAFF,CAjIY,EA4IZ,CACE,OADF,EAEE;AACEF,OAAK,EAAE,OADT;AAEEZ,SAAO,EAAE,mDAFX;AAGEgB,OAAK,EAAE;AACLG,aAAS,EAAE;AACT3K,aAAO,EAAE;AADA;AADN,GAHT;AAQEqK,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ;AARZ,CAFF,CA5IY,EA6JZ,CACE,4BADF,EAEE;AACEF,OAAK,EAAE,OADT;AAEEI,OAAK,EAAE;AACLI,UAAM,EAAE;AACN5K,aAAO,EAAE;AADH;AADH,GAFT;AAOEqK,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ;AAPZ,CAFF,CA7JY,EA6KZ,CACE,6BADF,EAEE;AACEF,OAAK,EAAE,QADT;AAEES,QAAM,EAAE,IAFV;AAGEC,MAAI,EAAE,IAHR;AAIEN,OAAK,EAAE;AACLI,UAAM,EAAE;AACN5K,aAAO,EAAE;AADH;AADH,GAJT;AASEqK,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ;AATZ,CAFF,CA7KY,EA+LZ,CACE,kBADF,EAEE;AACEO,QAAM,EAAE,KADV;AAEET,OAAK,EAAE,OAFT;AAGEU,MAAI,EAAE,IAHR;AAIEJ,YAAU,EAAE,IAJd;AAKEF,OAAK,EAAE;AACLO,iBAAa,EAAE;AACb/K,aAAO,EAAE;AADI;AADV,GALT;AAUEqK,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ;AAVZ,CAFF,CA/LY,EAkNZ,CACE,mBADF,EAEE;AACEO,QAAM,EAAE,IADV;AAEET,OAAK,EAAE,QAFT;AAGEM,YAAU,EAAE,IAHd;AAIEF,OAAK,EAAE;AACLO,iBAAa,EAAE;AACb/K,aAAO,EAAE;AADI;AADV,GAJT;AASEqK,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ;AATZ,CAFF,CAlNY,EAoOZ,CACE,WADF,EAEE;AACEO,QAAM,EAAE,IADV;AAEET,OAAK,EAAE,QAFT;AAGEM,YAAU,EAAE,KAHd;AAIEL,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ;AAJZ,CAFF,CApOY,EAiPZ,CACE,OADF,EAEE;AACEd,SAAO,EAAE,WADX;AAEEgB,OAAK,EAAE;AACLQ,yBAAqB,EAAE;AACrBhL,aAAO,EAAE;AADY,KADlB;AAILiL,UAAM,EAAE;AACNjL,aAAO,EAAE;AADH,KAJH;AAOLkL,cAAU,EAAE;AACVlL,aAAO,EAAE;AADC;AAPP,GAFT;AAaEmL,WAAS,EAAE,OAbb;AAcEC,WAAS,EAAE,IAdb;AAeEV,YAAU,EAAE,KAfd;AAgBEN,OAAK,EAAE,OAhBT;AAiBEC,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ;AAjBZ,CAFF,CAjPY,EA2QZ,CACE,aADF,EAEE;AACEd,SAAO,EACL,gFAFJ;AAGEgB,OAAK,EAAE;AACLa,WAAO,EAAE;AACPrL,aAAO,EAAE;AADF,KADJ;AAILsL,WAAO,EAAE;AACPtL,aAAO,EAAE;AADF,KAJJ;AAOLuL,YAAQ,EAAE;AACRvL,aAAO,EAAE;AADD,KAPL;AAULwL,cAAU,EAAE;AACVxL,aAAO,EAAE;AADC;AAVP,GAHT;AAiBEmL,WAAS,EAAE,aAjBb;AAkBEC,WAAS,EAAE,IAlBb;AAmBEjB,OAAK,EAAE,EAnBT;AAoBEE,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ;AApBZ,CAFF,CA3QY,EAwSZ,CACE,UADF,EAEE;AACEd,SAAO,EAAE,4BADX;AAEE2B,WAAS,EAAE,KAFb;AAGEd,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ;AAHZ,CAFF,CAxSY,EAoTZ,CACE,WADF,EAEE;AACEd,SAAO,EACL,kGAFJ;AAGEgB,OAAK,EAAE;AACLa,WAAO,EAAE;AACPrL,aAAO,EAAE;AADF,KADJ;AAILsL,WAAO,EAAE;AACPtL,aAAO,EAAE;AADF,KAJJ;AAOLuL,YAAQ,EAAE;AACRvL,aAAO,EAAE;AADD,KAPL;AAULwL,cAAU,EAAE;AACVxL,aAAO,EAAE;AADC;AAVP,GAHT;AAiBEmL,WAAS,EAAE,MAjBb;AAkBEhB,OAAK,EAAE,EAlBT;AAmBEiB,WAAS,EAAE,IAnBb;AAoBEf,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE,kCADP;AAEEmB,UAAM,EAAE;AAFV,GADQ,EAKR;AACEnB,OAAG,EAAE;AADP,GALQ;AApBZ,CAFF,CApTY,CAAd;AAuVA,IAAMH,KAAK,GAAG,CACZ,CACE,MADF,EAEE;AACEuB,UAAQ,EAAE,OADZ;AAEEtB,OAAK,EAAE,MAFT;AAGEI,OAAK,EAAE;AACL7E,QAAI,EAAE,EADD;AAELgG,wBAAoB,EAAE;AACpB3L,aAAO,EAAE;AADW;AAFjB,GAHT;AASE4L,WAAS,EAAE,KATb;AAUEvB,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ;AAVZ,CAFF,CADY,EAoBZ,CACE,IADF,EAEE;AACEsB,WAAS,EAAE,IADb;AAEExB,OAAK,EAAE,WAFT;AAGEC,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ,EAIR;AACEA,OAAG,EAAE;AADP,GAJQ,EAOR;AACE7S,SAAK,EAAE;AADT,GAPQ;AAHZ,CAFF,CApBY,EAsCZ,CACE,QADF,EAEE;AACEmU,WAAS,EAAE,IADb;AAEExB,OAAK,EAAE,WAFT;AAGEC,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ,EAIR;AACEA,OAAG,EAAE;AADP,GAJQ,EAOR;AACE7S,SAAK,EAAE;AADT,GAPQ;AAHZ,CAFF,CAtCY,EAwDZ,CACE,WADF,EAEE;AACE+S,OAAK,EAAE;AACLqB,SAAK,EAAE;AADF,GADT;AAIED,WAAS,EAAE,IAJb;AAKExB,OAAK,EAAE,OALT;AAMEC,UAAQ,EAAE,CACR;AACE5S,SAAK,EAAE;AADT,GADQ;AANZ,CAFF,CAxDY,EAuEZ,CACE,QADF,EAEE;AACEmU,WAAS,EAAE,IADb;AAEExB,OAAK,EAAE,WAFT;AAGEC,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ,EAIR;AACEA,OAAG,EAAE;AADP,GAJQ,EAOR;AACEA,OAAG,EAAE;AADP,GAPQ,EAUR;AACE7S,SAAK,EAAE;AADT,GAVQ;AAHZ,CAFF,CAvEY,EA4FZ,CACE,QADF,EAEE;AACEmU,WAAS,EAAE,IADb;AAEExB,OAAK,EAAE,WAFT;AAGEI,OAAK,EAAE;AACL7M,QAAI,EAAE;AACJqC,aAAO,EAAE;AADL;AADD,GAHT;AAQEqK,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE,KADP;AAEEE,SAAK,EAAE;AACL7M,UAAI,EAAE;AADD;AAFT,GADQ,EAOR;AACE2M,OAAG,EAAE,KADP;AAEEE,SAAK,EAAE;AACL7M,UAAI,EAAE;AADD;AAFT,GAPQ;AARZ,CAFF,CA5FY,EAsHZ,CACE,WADF,EAEE;AACEiO,WAAS,EAAE,IADb;AAEExB,OAAK,EAAE,WAFT;AAGEC,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ,EAIR;AACE7S,SAAK,EAAE;AADT,GAJQ;AAHZ,CAFF,CAtHY,EAqIZ,CACE,MADF,EAEE;AACEiU,UAAQ,EAAE,kCADZ;AAEEE,WAAS,EAAE,IAFb;AAGEvB,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE,WADP;AAEEwB,sBAAkB,EAAE;AAFtB,GADQ,EAKR;AACExB,OAAG,EAAE,MADP;AAEEwB,sBAAkB,EAAE;AAFtB,GALQ,EASR;AACExB,OAAG,EAAE,IADP;AAEEwB,sBAAkB,EAAE;AAFtB,GATQ,EAaR;AACExB,OAAG,EAAE,MADP;AAEEwB,sBAAkB,EAAE;AAFtB,GAbQ;AAHZ,CAFF,CArIY,EA8JZ,CACE,gBADF,EAEE;AACEJ,UAAQ,EAAE,aADZ;AAEEE,WAAS,EAAE,IAFb;AAGExB,OAAK,EAAE,aAHT;AAIEC,UAAQ,EAAE,CACR;AACEC,OAAG,EAAE;AADP,GADQ,CAJZ;AASEE,OAAK,EAAE;AACLuB,WAAO,EAAE;AACP/L,aAAO,EAAE;AADF;AADJ;AATT,CAFF,CA9JY,CAAd;;AAkLA,SAASgM,eAAT,CAAyBC,OAAzB,EAAkC;AAChC,SAAOA,OAAO,CAACzK,MAAR,CAAe,UAAS0K,GAAT,EAAcC,GAAd,EAAmB;AACvCD,OAAG,CAACC,GAAG,CAAC,CAAD,CAAJ,CAAH,GAAcA,GAAG,CAAC,CAAD,CAAjB;AACA,WAAOD,GAAP;AACD,GAHM,EAGJ,EAHI,CAAP;AAID;;AAEM,IAAMxG,aAAa,GAAG;AAC3BwE,OAAK,EAALA,KAD2B;AAE3BC,OAAK,EAALA;AAF2B,CAAtB;AAKA,IAAMiC,YAAY,GAAG;AAC1BlC,OAAK,EAAE8B,eAAe,CAAC9B,KAAD,CADI;AAE1BC,OAAK,EAAE6B,eAAe,CAAC7B,KAAD;AAFI,CAArB;AAKP,IAAMvH,MAAM,GAAG,IAAIyJ,wDAAJ,CAAWD,YAAX,CAAf;AAEexJ,qEAAf,E;;;;;;;ACpiBA;AACA7C,mBAAO,CAAC,MAAD,CAAP;;AACAA,mBAAO,CAAC,MAAD,CAAP,C;;;;;;;;ACFA;AAAA;AACA;AACA;AACA,IAAMpH,YAAY,GAAG;AACnB2T,aAAW,EAAE,IADM;AAEnBC,WAAS,EAAE,IAFQ;AAGnBC,YAAU,EAAE,IAHO;AAInBC,gBAAc,EAAE,IAJG;AAKnBC,YAAU,EAAE;AALO,CAArB;AAQe/T,2EAAf,E;;;;;;;;ACXA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAEe,SAASgU,eAAT,OAAwC;AAAA,MAAbxU,SAAa,QAAbA,SAAa;AACrD,MAAM0H,QAAQ,GAAG+M,wDAAU,CAACzG,iDAAD,CAA3B;;AACA,MAAIhO,SAAJ,EAAe;AACb,WACE,2DAAC,+DAAD;AACE,UAAI,EAAC,UADP;AAEE,UAAI,EAAEA,SAFR;AAGE,eAAS,EAAC,cAHZ;AAIE,YAAM;AAJR,MADF;AAQD,GATD,MASO,IAAI,CAAC0H,QAAL,EAAe;AACpB,WACE,2DAAC,2DAAD;AACE,UAAI,EAAC,UADP;AAEE,SAAG,EAAEqG,qDAFP;AAGE,QAAE,EAAC,GAHL;AAIE,eAAS,EAAC,cAJZ;AAKE,YAAM;AALR,MADF;AASD,GAVM,MAUA;AACL,WAAO,IAAP;AACD;AACF,C;;;;;;;AC7BD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA,IAAM2G,YAAY,GAAG7G,mEAAU,CAAC,UAAA9O,KAAK,EAAI;AACvC,MAAMiB,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","file":"app/notes.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"\" + ({}[chunkId]||chunkId) + \"/notes.js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// The chunk loading function for additional chunks\n \t// Since all referenced chunks are already included\n \t// in this file, this function is empty here.\n \t__webpack_require__.e = function requireEnsure() {\n \t\treturn Promise.resolve();\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import React from 'react'\n\nconst HeaderMenu = props => (\n  <header className={'page-header-menu ' + (props.className || '')}>\n    <div className=\"page-header-menu--left\">{props.left}</div>\n    {props.children}\n    <div className=\"page-header-menu--right\">{props.right}</div>\n  </header>\n)\n\nexport default HeaderMenu\n","var map = {\n\t\"./en\": \"7dT6\",\n\t\"./en.json\": \"7dT6\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"/KVF\";","// extracted by mini-css-extract-plugin","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","import React, { useCallback, useRef, useEffect } from 'react'\n\nimport { Editor, WithEditorActions } from '@atlaskit/editor-core'\n\nimport { MainTitle } from 'cozy-ui/react/Text'\nimport Textarea from 'cozy-ui/react/Textarea'\n\nimport editorConfig from './editor_config'\nimport BackFromEditing from './back_from_editing'\nimport HeaderMenu from '../header_menu'\n\nfunction updateTextareaHeight(target) {\n  target.style.height = 'inherit'\n  target.style.height = `${target.scrollHeight}px`\n}\n\nexport default function EditorView(props) {\n  const {\n    defaultValue,\n    onTitleChange,\n    onContentChange,\n    defaultTitle,\n    title,\n    collabProvider,\n    returnUrl\n  } = props\n\n  const titleEl = useRef(null)\n\n  const onTitleEvent = useCallback(\n    e => {\n      const target = e.target\n      updateTextareaHeight(target)\n      if (onTitleChange) onTitleChange(e)\n    },\n    [onTitleChange]\n  )\n\n  useEffect(() => updateTextareaHeight(titleEl.current), [])\n\n  return (\n    <article className=\"note-article\">\n      <style>#coz-bar {'{ display: none }'}</style>\n      <HeaderMenu\n        left={<BackFromEditing returnUrl={returnUrl} />}\n        className=\"note-header-menu--editing\"\n      />\n      <section className=\"note-editor-container\">\n        <Editor\n          collabEdit={collabProvider}\n          onChange={onContentChange}\n          defaultValue={defaultValue}\n          {...editorConfig}\n          appearance=\"full-page\"\n          placeholder=\"Que voulez-vous dire ?\"\n          shouldFocus={true}\n          contentComponents={\n            <WithEditorActions\n              render={() => (\n                <MainTitle tag=\"h1\" className=\"note-title\">\n                  <Textarea\n                    ref={titleEl}\n                    rows=\"1\"\n                    fullwidth={true}\n                    value={title}\n                    onChange={onTitleEvent}\n                    placeholder={defaultTitle}\n                    className=\"note-title-input\"\n                  />\n                </MainTitle>\n              )}\n            />\n          }\n        />\n      </section>\n    </article>\n  )\n}\n","export const getParticipant = ({ userId, sessionId }) => ({\n  userId: sessionId,\n  sessionId: sessionId || userId,\n  name: userId,\n  avatar: `https://api.adorable.io/avatars/80/${userId.replace(\n    /[^a-zA-Z0-9]/g,\n    ''\n  )}.png`,\n  email: `${userId\n    .replace(/\\s+/g, '.')\n    .replace(/[^a-zA-Z0-9.]/g, '')}.toLocaleLowerCase()}@mycozy.cloud`\n})\n","import { EventEmitter2 } from 'eventemitter2'\nimport { getVersion, sendableSteps } from 'prosemirror-collab'\n\nexport class Channel {\n  constructor(config, serviceClient) {\n    this.config = config\n    this.service = serviceClient\n    this.eventEmitter = new EventEmitter2()\n  }\n\n  /**\n   * Connect to pubsub to start receiving events\n   */\n  async connect(version, doc) {\n    const { docId } = this.config\n    this.service.join(docId)\n    this.service.onStepsCreated(docId, data => {\n      this.emit('data', { version: data.version, steps: [data] })\n    })\n    this.service.onTelepointerUpdated(docId, payload => {\n      this.emit('telepointer', payload)\n    })\n    this.eventEmitter.emit('connected', {\n      doc,\n      version\n    })\n  }\n\n  debounce(getState) {\n    if (this.debounced) {\n      clearTimeout(this.debounced)\n    }\n\n    this.debounced = window.setTimeout(() => {\n      this.sendSteps(getState(), getState)\n    }, 250)\n  }\n\n  /**\n   * Send steps to service\n   */\n  async sendSteps(state, getState, localSteps) {\n    const { docId } = this.config\n\n    if (this.isSending) {\n      this.debounce(getState)\n      return\n    }\n\n    const version = getVersion(state)\n\n    // Don't send any steps before we're ready.\n    if (typeof version === undefined) {\n      return\n    }\n\n    const { steps } = localSteps || sendableSteps(state) || { steps: [] } // sendableSteps can return null..\n\n    if (steps.length === 0) {\n      return\n    }\n\n    this.isSending = true\n    try {\n      const response = await this.service.pushSteps(docId, version, steps)\n      this.isSending = false\n      if (response && response.steps && response.steps.length > 0) {\n        this.emit('data', response)\n      }\n    } catch (err) {\n      this.debounce(getState)\n      this.isSending = false\n    }\n  }\n\n  /**\n   * Get steps from version x to latest\n   */\n  async getSteps(version) {\n    const { docId } = this.config\n    return await this.service.getSteps(docId, version)\n  }\n\n  /**\n   * Send telepointer\n   */\n  async sendTelepointer(data) {\n    const { docId } = this.config\n    return await this.service.pushTelepointer(docId, data)\n  }\n\n  /**\n   * Subscribe to events emitted by this channel\n   */\n  on(evt, handler) {\n    this.eventEmitter.on(evt, handler)\n    return this\n  }\n\n  /**\n   * Unsubscribe from events emitted by this channel\n   */\n  off(evt, handler) {\n    this.eventEmitter.off(evt, handler)\n    return this\n  }\n\n  /**\n   * Emit events to subscribers\n   */\n  emit(evt, data) {\n    this.eventEmitter.emit(evt, data)\n    return this\n  }\n}\n","import { EventEmitter2 } from 'eventemitter2'\nimport { getVersion, sendableSteps } from 'prosemirror-collab'\nimport { JSONTransformer } from '@atlaskit/editor-json-transformer'\nimport { Channel } from './channel'\nimport { getParticipant } from './participant'\n\nconst jsonTransformer = new JSONTransformer()\n\nexport class CollabProvider {\n  constructor(config, serviceClient) {\n    this.config = config\n    this.config['sessionId'] = serviceClient.getSessionId()\n    this.config['userId'] = serviceClient.getUserId()\n    this.serviceClient = serviceClient\n    this.channel = config.channel || new Channel(config, serviceClient)\n    this.eventEmitter = new EventEmitter2()\n    this.queue = []\n    this.getState = () => {}\n    this.participants = new Map()\n    this.pauseQueue = false\n    this.initialVersion = config.version\n  }\n\n  initialize(getState) {\n    this.getState = getState\n    this.channel.on('connected', ({ doc, version }) => {\n      const { sessionId } = this.config\n      this.emit('init', { sid: sessionId, doc, version }) // Set initial document\n      this.emit('connected', { sid: sessionId }) // Let the plugin know that we're connected an ready to go\n    })\n    this.channel.on('data', this.onReceiveData)\n    this.channel.on('telepointer', this.onReceiveTelepointer)\n    const state = getState()\n    const doc = jsonTransformer.encode(state.doc)\n    const usableVersion =\n      this.initialVersion !== undefined ? this.initialVersion : doc.version\n    const collabDoc = { ...doc, version: usableVersion }\n    this.channel.connect(\n      usableVersion,\n      collabDoc\n    )\n\n    return this\n  }\n\n  /**\n   * Send steps from transaction to other participants\n   */\n  send(tr, oldState, newState) {\n    // Ignore transactions without steps\n    if (!tr.steps || !tr.steps.length) {\n      return\n    }\n\n    this.channel.sendSteps(newState, this.getState)\n  }\n\n  /**\n   * Send messages, such as telepointers, to other participants.\n   */\n  sendMessage(data) {\n    if (!data) {\n      return\n    }\n\n    const { type } = data\n    switch (type) {\n      case 'telepointer':\n        this.channel.sendTelepointer({\n          ...data,\n          timestamp: new Date().getTime()\n        })\n    }\n  }\n\n  queueData(data) {\n    const orderedQueue = [...this.queue, data].sort((a, b) => {\n      // order by starting version\n      const aStart = a.version - a.steps.length\n      const bStart = b.version - b.steps.length\n      if (aStart > bStart) return 1\n      if (aStart < bStart) return -1\n      // for same starting version, keep first the one going further\n      if (a.version > b.version) return -1\n      if (a.version > b.version) return 1\n      return 0\n    })\n    this.queue = orderedQueue\n  }\n\n  async catchup() {\n    const currentVersion = getVersion(this.getState())\n    try {\n      const { doc, version, steps } = await this.channel.getSteps(\n        currentVersion\n      )\n      if (doc) {\n        // we lag too much, server did send us the whole document\n        const { sessionId } = this.config\n        // get local steps\n        const { steps: localSteps = [] } = sendableSteps(this.getState()) || {}\n        // Replace local document and version number\n        this.emit('init', { sid: sessionId, doc, version })\n        // Re-aply local steps\n        if (localSteps.length) {\n          this.emit('local-steps', { steps: localSteps })\n        }\n      } else {\n        // we got steps to apply\n        this.onReceiveData({ steps, version }, true)\n      }\n      // processQueue again\n      this.queueTimeout = undefined\n      this.processQueue()\n    } catch (err) {\n      // something got wrong, try to catchup again\n      // TODO : maybe try to reinit the full doc ?\n      this.programCatchup()\n    }\n  }\n\n  programCatchup() {\n    if (!this.queueTimeout) {\n      this.queueTimeout = window.setTimeout(() => {\n        this.catchup()\n      }, 1000)\n    }\n  }\n\n  cancelCatchup() {\n    if (this.queueTimeout) {\n      window.clearTimeout(this.queueTimeout)\n      this.queueTimeout = undefined\n    }\n  }\n\n  processQueue() {\n    if (this.queue.length > 0) {\n      let currentVersion = getVersion(this.getState())\n      while (this.queue.length > 0) {\n        const first = this.queue[0]\n        const firstVersion = first.version\n        const expectedVersion = first.steps.length + currentVersion\n        if (firstVersion == expectedVersion) {\n          // process item\n          this.cancelCatchup()\n          this.queue.shift()\n          this.processRemoteData(first)\n          currentVersion = firstVersion\n        } else {\n          if (firstVersion <= expectedVersion) {\n            // item is obsolete, we won't be able to process it\n            this.queue.shift()\n          }\n          if (firstVersion > expectedVersion) {\n            // we miss some steps\n            this.programCatchup()\n            break\n          }\n        }\n      }\n    }\n  }\n\n  processRemoteData = data => {\n    const { version, steps } = data\n\n    if (steps && steps.length) {\n      const userIds = steps.map(\n        step => step.sessionId || this.serviceClient.getUserId(step.sessionId)\n      )\n      this.emit('data', { json: steps, version, userIds })\n    } else {\n      console.warn(\n        'Collab.Provider: processRemoteData no steps ? ',\n        steps,\n        data\n      )\n    }\n  }\n\n  onReceiveData = data => {\n    this.queueData(data)\n    this.processQueue()\n  }\n\n  onReceiveTelepointer = data => {\n    const { sessionId } = data\n    const userId = this.serviceClient.getUserId(sessionId)\n    if (userId === this.config.userId) {\n      return\n    }\n\n    const participant = this.participants.get(userId)\n    if (participant && participant.lastActive > data.timestamp) {\n      return\n    }\n\n    this.updateParticipant(sessionId, data.timestamp)\n    this.emit('telepointer', data)\n  }\n\n  updateParticipant(sessionId, timestamp) {\n    const userId = this.serviceClient.getUserId(sessionId)\n    const participant = getParticipant({ userId, sessionId })\n\n    this.participants.set(userId, {\n      name: '',\n      email: '',\n      avatar: '',\n      sessionId: sessionId,\n      userId: userId,\n      ...participant,\n      lastActive: timestamp\n    })\n\n    const joined = [this.participants.get(userId)]\n\n    // Filter out participants that's been inactive for\n    // more than 5 minutes.\n\n    const now = new Date().getTime()\n    const left = Array.from(this.participants.values()).filter(\n      p => (now - p.lastActive) / 1000 > 300\n    )\n\n    left.forEach(p => this.participants.delete(p.userId))\n    this.emit('presence', { joined, left })\n  }\n\n  /**\n   * Emit events to subscribers\n   */\n  emit(evt, data) {\n    this.eventEmitter.emit(evt, data)\n    return this\n  }\n\n  /**\n   * Subscribe to events emitted by this provider\n   */\n  on(evt, handler) {\n    this.eventEmitter.on(evt, handler)\n    return this\n  }\n\n  /**\n   * Unsubscribe from events emitted by this provider\n   */\n  off(evt, handler) {\n    this.eventEmitter.off(evt, handler)\n    return this\n  }\n\n  /**\n   * Unsubscribe all listeners for this event\n   */\n  unsubscribeAll(evt) {\n    this.eventEmitter.removeAllListeners(evt)\n  }\n}\n\nexport default CollabProvider\n","import SpriteSymbol from \"../../../../create-cozy-app/packages/cozy-scripts/node_modules/svg-baker-runtime/browser-symbol.js\";\nimport sprite from \"../../../../create-cozy-app/packages/cozy-scripts/node_modules/svg-sprite-loader/runtime/browser-sprite.build.js\";\nvar symbol = new SpriteSymbol({\n  \"id\": \"icon-note-32_0b87f187ce7a65cb93dbf28b37a73b8d\",\n  \"use\": \"icon-note-32_0b87f187ce7a65cb93dbf28b37a73b8d-usage\",\n  \"viewBox\": \"0 0 32 32\",\n  \"content\": \"<symbol xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" viewBox=\\\"0 0 32 32\\\" id=\\\"icon-note-32_0b87f187ce7a65cb93dbf28b37a73b8d\\\">\\n<style type=\\\"text/css\\\">\\n\\t#icon-note-32_0b87f187ce7a65cb93dbf28b37a73b8d .st0{fill-rule:evenodd;clip-rule:evenodd;fill:#ACF5F7;}\\n\\t#icon-note-32_0b87f187ce7a65cb93dbf28b37a73b8d .st1{fill-rule:evenodd;clip-rule:evenodd;fill:#0DCBCF;}\\n</style>\\n<g transform=\\\"translate(2)\\\">\\n\\t<path class=\\\"st0\\\" d=\\\"M0,2c0-1.1,0.9-2,2-2h22c1.1,0,2,0.9,2,2v28c0,1.1-0.9,2-2,2H2c-1.1,0-2-0.9-2-2V2z\\\" />\\n\\t<path class=\\\"st1\\\" d=\\\"M6,8h14v2H6V8z M6,12h8v2H6V12z M6,16h14v2H6V16z M6,20h10v2H6V20z\\\" />\\n</g>\\n<g transform=\\\"translate(0 4)\\\">\\n\\t<path class=\\\"st1\\\" d=\\\"M1.5,0h2C4.3,0,5,0.7,5,1.5l0,0C5,2.3,4.3,3,3.5,3h-2C0.7,3,0,2.3,0,1.5l0,0C0,0.7,0.7,0,1.5,0z\\\" />\\n\\t<path class=\\\"st1\\\" d=\\\"M1.5,7h2C4.3,7,5,7.7,5,8.5l0,0C5,9.3,4.3,10,3.5,10h-2C0.7,10,0,9.3,0,8.5l0,0C0,7.7,0.7,7,1.5,7z\\\" />\\n\\t<path class=\\\"st1\\\" d=\\\"M1.5,14h2C4.3,14,5,14.7,5,15.5l0,0C5,16.3,4.3,17,3.5,17h-2C0.7,17,0,16.3,0,15.5l0,0C0,14.7,0.7,14,1.5,14z\\\" />\\n\\t<path class=\\\"st1\\\" d=\\\"M1.5,21h2C4.3,21,5,21.7,5,22.5l0,0C5,23.3,4.3,24,3.5,24h-2C0.7,24,0,23.3,0,22.5l0,0C0,21.7,0.7,21,1.5,21z\\\" />\\n</g>\\n<g>\\n\\t<path class=\\\"st1\\\" d=\\\"M31.4,18.4l-2.8-2.8c0.8-0.8,2-0.8,2.8,0S32.2,17.6,31.4,18.4z\\\" />\\n\\t<path class=\\\"st1\\\" d=\\\"M30.7,19.1L20.8,29l-2.5,0.9c-0.5,0.2-1.1-0.1-1.3-0.6c-0.1-0.2-0.1-0.5,0-0.7l0.9-2.5l9.9-9.9L30.7,19.1z\\\" />\\n</g>\\n</symbol>\"\n});\nvar result = sprite.add(symbol);\nexport default symbol","/* global cozy */\n\nimport 'styles'\n\nimport React from 'react'\nimport CozyClient, { CozyProvider } from 'cozy-client'\nimport { render } from 'react-dom'\nimport { I18n } from 'cozy-ui/react/I18n'\nimport { schema } from 'components/notes'\nimport IsPublic from 'components/IsPublic'\n\nlet appLocale\nconst renderApp = function(client, isPublic) {\n  const App = require('components/app').default\n  render(\n    <I18n\n      lang={appLocale}\n      dictRequire={appLocale => require(`locales/${appLocale}`)}\n    >\n      <CozyProvider client={client}>\n        <IsPublic.Provider value={isPublic}>\n          <App isPublic={isPublic} />\n        </IsPublic.Provider>\n      </CozyProvider>\n    </I18n>,\n    document.querySelector('[role=application]')\n  )\n}\n\n// return a defaultData if the template hasn't been replaced by cozy-stack\nconst getDataOrDefault = function(toTest, defaultData) {\n  const templateRegex = /^\\{\\{\\.[a-zA-Z]*\\}\\}$/ // {{.Example}}\n  return templateRegex.test(toTest) ? defaultData : toTest\n}\n\nconst getDataset = function() {\n  const root = document.querySelector('[role=application]')\n  return root.dataset\n}\n\nconst getToken = function(dataset) {\n  if (\n    dataset &&\n    dataset.cozyToken &&\n    dataset.cozyToken.length > 0 &&\n    dataset.cozyToken[0] != '{'\n  ) {\n    return { isPublic: false, token: dataset.cozyToken }\n  } else {\n    const arrToObj = (obj = {}, [key, val = true]) => {\n      obj[key] = val\n      return obj\n    }\n    const { sharecode } = window.location.search\n      .substring(1)\n      .split('&')\n      .map(varval => varval.split('='))\n      .reduce(arrToObj, {})\n    return { isPublic: true, token: sharecode }\n  }\n}\n\n// initial rendering of the application\ndocument.addEventListener('DOMContentLoaded', () => {\n  const data = getDataset()\n\n  const appIcon = getDataOrDefault(\n    data.cozyIconPath,\n    require('../vendor/assets/icon.svg')\n  )\n\n  const appNamePrefix = getDataOrDefault(\n    data.cozyAppNamePrefix || require('../../../manifest.webapp').name_prefix,\n    ''\n  )\n\n  const appName = getDataOrDefault(\n    data.cozyAppName,\n    require('../../../manifest.webapp').name\n  )\n\n  const appSlug = getDataOrDefault(\n    data.cozyAppSlug,\n    require('../../../manifest.webapp').slug\n  )\n\n  const appVersion = getDataOrDefault(\n    data.cozyAppVersion,\n    require('../../../manifest.webapp').version\n  )\n\n  appLocale = getDataOrDefault(data.cozyLocale, 'en')\n\n  const protocol = window.location ? window.location.protocol : 'https:'\n\n  const { isPublic, token } = getToken(data)\n\n  // initialize the client to interact with the cozy stack\n  const client = new CozyClient({\n    uri: `${protocol}//${data.cozyDomain}`,\n    token: token,\n    schema,\n    appMetadata: {\n      slug: appSlug,\n      version: appVersion\n    }\n  })\n\n  if (!isPublic) {\n    // initialize the bar, common of all applications, it allows\n    // platform features like apps navigation without doing anything\n    cozy.bar.init({\n      appName: appName,\n      appNamePrefix: appNamePrefix,\n      iconPath: appIcon,\n      lang: appLocale,\n      replaceTitleOnMobile: true,\n      cozyClient: client,\n      isPublic: isPublic\n    })\n  }\n\n  renderApp(client, isPublic)\n})\n","import React, { useCallback, useState, useEffect, useMemo } from 'react'\n\nimport { withClient } from 'cozy-client'\n\nimport EditorView from './editor-view'\nimport EditorLoading from './editor-loading'\n\nimport CollabProvider from '../../lib/collab/provider'\nimport ServiceClient from '../../lib/collab/stack-client'\n\nimport { getShortNameFromClient, getParentFolderLink } from '../../lib/utils.js'\n\nconst Editor = withClient(function(props) {\n  const { client, noteId } = props\n  const userName = useMemo(\n    () => props.userName || getShortNameFromClient(client),\n    [props.userName]\n  )\n\n  // alias for later shortcuts\n  const docId = noteId\n  const userId = userName\n  const cozyClient = client\n\n  // state\n  const [loading, setLoading] = useState(true)\n  const [doc, setDoc] = useState(undefined)\n  const [title, setTitle] = useState(undefined)\n\n  // plugins and config\n  const serviceClient = useMemo(\n    () => {\n      return new ServiceClient({ userId, userName, cozyClient })\n    },\n    [noteId]\n  )\n  const docVersion = doc && doc.version\n  //console.log(\"docVersion\", doc, doc && doc.version, docVersion)\n  const collabProvider = useMemo(\n    () => {\n      //console.log(\"collab provider memo\", docVersion)\n      if (docVersion !== undefined) {\n        //console.log('new collabProvider')\n        const provider = new CollabProvider(\n          { version: doc.version, docId },\n          serviceClient\n        )\n        return {\n          useNativePlugin: true,\n          provider: Promise.resolve(provider),\n          inviteToEditHandler: () => undefined,\n          isInviteToEditButtonSelected: false,\n          userId: serviceClient.getSessionId()\n        }\n      } else {\n        return null\n      }\n    },\n    [noteId, docVersion, userName, serviceClient]\n  )\n  //console.log(\"end collabProviderMemo\", collabProvider)\n\n  // fetch the actual note on load\n  useEffect(\n    () => {\n      const fn = async function() {\n        try {\n          if (!loading) {\n            setLoading(true)\n          }\n          const doc = await serviceClient.getDoc(noteId)\n          setTitle(doc.title || '')\n          setDoc(doc)\n        } catch (e) {\n          setTitle(false)\n          setDoc(false)\n        }\n        setLoading(false)\n      }\n      fn()\n    },\n    [noteId]\n  )\n\n  // callbacks\n  const onContentChange = useCallback(() => null, [noteId])\n  const onLocalTitleChange = useCallback(\n    e => {\n      const newTitle = e.target.value\n      const modifiedTitle = newTitle\n      if (title != modifiedTitle) {\n        setTitle(modifiedTitle)\n        serviceClient.setTitle(noteId, modifiedTitle)\n      }\n    },\n    [noteId, setTitle, serviceClient]\n  )\n  const onRemoteTitleChange = useCallback(\n    modifiedTitle => {\n      if (title != modifiedTitle) {\n        setTitle(modifiedTitle)\n      }\n    },\n    [noteId, setTitle]\n  )\n  useMemo(\n    () => {\n      serviceClient.onTitleUpdated(noteId, onRemoteTitleChange)\n    },\n    [onRemoteTitleChange, serviceClient]\n  )\n  // Failure in loading the note ?\n  useEffect(() => {\n    if (!loading && !doc) {\n      // eslint-disable-next-line no-console\n      console.warn(`Could not load note ${noteId}`)\n      props.history.push(`/`)\n    }\n  })\n\n  const returnUrl = useMemo(\n    () => {\n      if (props.returnUrl !== undefined) {\n        return props.returnUrl\n      } else if (doc) {\n        return getParentFolderLink(client, doc.file)\n      } else {\n        return props.returnUrl\n      }\n    },\n    [props.returnUrl, doc]\n  )\n\n  // rendering\n  if (loading || !doc) {\n    return <EditorLoading />\n  } else {\n    return (\n      <EditorView\n        onTitleChange={onLocalTitleChange}\n        onContentChange={onContentChange}\n        collabProvider={collabProvider}\n        defaultTitle={'Ici votre titre'}\n        defaultValue={{ ...doc.doc, version: doc.version }}\n        title={title && title.length > 0 ? title : undefined}\n        returnUrl={returnUrl}\n      />\n    )\n  }\n})\n\nexport default Editor\n","import React, { Component } from 'react'\n\nimport { withClient } from 'cozy-client'\n\nimport { withRouter } from 'react-router-dom'\n\nimport Button from 'cozy-ui/react/Button'\n\nimport { schemaOrdered } from '../../lib/collab/schema'\nimport { generateReturnUrlToNotesIndex } from '../../lib/utils'\n\nclass Add extends Component {\n  constructor(props, context) {\n    super(props, context)\n    // initial component state\n    this.state = {\n      isWorking: false\n    }\n  }\n\n  handleClick = async () => {\n    this.setState(() => {\n      true\n    })\n    const { client: cozyClient } = this.props\n    const { data: doc } = await cozyClient\n      .getStackClient()\n      .fetchJSON('POST', '/notes', {\n        data: {\n          type: 'io.cozy.notes.documents',\n          attributes: {\n            title: '',\n            schema: schemaOrdered\n          }\n        }\n      })\n    this.setState(() => {\n      false\n    })\n\n    window.location.href = generateReturnUrlToNotesIndex(doc)\n  }\n\n  render() {\n    const { isWorking } = this.state\n    return (\n      <div>\n        <Button\n          onClick={this.handleClick}\n          type=\"submit\"\n          busy={isWorking}\n          icon=\"plus\"\n          label=\"ajouter une note\"\n          extension=\"narrow\"\n        />\n      </div>\n    )\n  }\n}\n\n// get mutations from the client to use createDocument\nexport default withClient(withRouter(Add))\n","import React from 'react'\n\nimport { Link } from 'react-router-dom'\n\nimport HeaderMenu from '../header_menu'\n\nimport Spinner from 'cozy-ui/react/Spinner'\nimport Button from 'cozy-ui/react/Button'\n\nexport default function EditorLoading() {\n  const left = (\n    <Button\n      icon=\"back\"\n      tag={Link}\n      to=\"/\"\n      className=\"sto-app-back\"\n      label=\"Retour  la liste\"\n      subtle\n    />\n  )\n  return (\n    <div>\n      <HeaderMenu left={left} />\n      <Spinner size=\"xxlarge\" middle />\n    </div>\n  )\n}\n","module.exports = \"/img/icon.svg\";","import React from 'react'\n\nconst IsPublic = React.createContext(false)\nexport default IsPublic\n","import List from './list'\nimport Editor from './editor'\nimport Add from './add'\n\n//\nexport { List, Editor, Add }\n","import React from 'react'\n\nimport Spinner from 'cozy-ui/react/Spinner'\nimport { Link } from 'react-router-dom'\n\nimport ListItemText from 'cozy-ui/react/ListItemText'\nimport Button from 'cozy-ui/react/Button'\nimport Icon from 'cozy-ui/react/Icon'\nimport { MainTitle } from 'cozy-ui/react/Text'\n\nimport Add from './add'\n\nimport HeaderMenu from '../header_menu.jsx'\n\nimport icon from '../../assets/icons/icon-note-32.svg'\n\nconst titleWithDefault = () => {}\n\nconst Item = props => (\n  <div className=\"note-item\">\n    <Icon icon={icon} width={32} height={32} className=\"note-icon\" />\n    <Link to={`/n/${props.note.id}`} className=\"note-link\">\n      <ListItemText\n        primaryText={titleWithDefault(props.note)}\n        secondaryText=\"/Notes/2019/demo\"\n      />\n    </Link>\n  </div>\n)\n\nconst Row = props => {\n  const updatedAt = new Date(props.note.cozyMetadata.updatedAt)\n  const options = { day: 'numeric', month: 'long', year: 'numeric' }\n  const formatedUpdatedAt = updatedAt.toLocaleDateString(undefined, options)\n  return (\n    <tr className=\"c-table-row\">\n      <th className=\"c-table-cell c-table-cell--primary\">\n        <Item {...props} />\n      </th>\n      <td className=\"c-table-cell\">\n        <time datatime={props.note.cozyMetadata.updatedAt}>\n          {formatedUpdatedAt}\n        </time>\n      </td>\n      <td className=\"c-table-cell\"></td>\n      <td className=\"c-table-cell\">\n        <Button\n          theme=\"action\"\n          extension=\"narrow\"\n          icon={<Icon icon=\"dots\" color=\"coolGrey\" width=\"17\" height=\"17\" />}\n          iconOnly\n          label=\"actions\"\n        />\n      </td>\n    </tr>\n  )\n}\n\nconst List = props => {\n  const { notes } = props\n  return !notes || !notes.length ? null : (\n    <table className=\"notes-list c-table\">\n      <thead className=\"c-table-head\">\n        <tr className=\"c-table-row-head\">\n          <th className=\"c-table-header\">Nom</th>\n          <th className=\"c-table-header\">Dernire mise  jour</th>\n          <th className=\"c-table-header\">Partages</th>\n          <th className=\"c-table-header\" />\n        </tr>\n      </thead>\n      <tbody>\n        {notes.map(note => (\n          <Row key={note._id} note={note} />\n        ))}\n      </tbody>\n    </table>\n  )\n}\n\nconst ListHeader = () => {\n  return (\n    <>\n      <HeaderMenu\n        left={<MainTitle tag=\"h1\">Mes notes</MainTitle>}\n        right={<Add />}\n      />\n    </>\n  )\n}\n\nconst ConnectedList = props => {\n  const { data, fetchStatus } = props.notes\n  // cozy-client statuses\n  const isLoading = fetchStatus === 'loading' || fetchStatus === 'pending'\n  return (\n    <div className=\"notes notes-list-container\">\n      {isLoading ? (\n        <Spinner size=\"xxlarge\" middle />\n      ) : (\n        <div>\n          <ListHeader />\n          <List notes={data} />\n        </div>\n      )}\n    </div>\n  )\n}\n\nexport default ListHeader\n","import CozyRealtime from 'cozy-realtime'\n\nimport { schemaOrdered as defaultSchema } from './schema'\n\n// Warning: sessionID on the server, sessionId on the client\n\nexport class ServiceClient {\n  constructor(config) {\n    const { userId, cozyClient, schema } = config\n    const now = new Date()\n    const sessionSuffix =\n      now.getTime() + '.' + now.getMilliseconds() + '.' + Math.random()\n    this.sessionId = userId + ':' + sessionSuffix\n    this.userId = this.getUserId(userId)\n    this.cozyClient = cozyClient\n    this.stackClient = cozyClient.getStackClient()\n    this.schema = schema\n    this.onRealtimeEvent = this.onRealtimeEvent.bind(this)\n    this.realtime = new CozyRealtime({ client: cozyClient })\n    this.resetCallbacks()\n  }\n\n  resetCallbacks() {\n    this.callbacks = {}\n  }\n\n  setCallback(type, id, callback) {\n    this.callbacks[type] = this.callbacks[type] || {}\n    this.callbacks[type][id] = callback\n  }\n\n  getUserId(sessionId) {\n    return sessionId ? sessionId.match(/[^:]+/)[0] : this.userId\n  }\n\n  getSessionId() {\n    return this.sessionId\n  }\n\n  close() {\n    this.realtime.unsubscribeAll()\n    this.resetCallbacks()\n  }\n\n  defaultTitle() {\n    return new Date().toISOString()\n  }\n\n  path(id, sub) {\n    return id ? (sub ? `/notes/${id}/${sub}` : `/notes/${id}`) : '/notes'\n  }\n\n  client2server(data) {\n    return { sessionID: data.sessionId || this.sessionId, ...data }\n  }\n\n  server2client(data) {\n    return {\n      sessionId: data.sessionID,\n      userId: this.getUserId(data.sessionID),\n      ...data\n    }\n  }\n\n  async create(title, schema) {\n    const doc = {\n      data: {\n        type: 'io.cozy.notes.documents',\n        attributes: {\n          title: title || this.defaultTitle(),\n          schema: schema || this.schema || defaultSchema\n        }\n      }\n    }\n    return this.stackClient.fetchJSON('POST', this.path(), doc)\n  }\n\n  async setTitle(docId, title) {\n    const titleDoc = {\n      data: {\n        type: 'io.cozy.notes.documents',\n        id: docId,\n        attributes: this.client2server({ title: title })\n      }\n    }\n    await this.stackClient.fetchJSON('PUT', this.path(docId, 'title'), titleDoc)\n  }\n\n  onRealtimeEvent(doc) {\n    const id = doc.id || doc._id\n    const type = doc.doctype\n    if (this.callbacks[type] && this.callbacks[type][id]) {\n      return this.callbacks[type][id](doc)\n    } else {\n      // eslint-disable-next-line no-console\n      console.warn('Event not manager', type, id, this.callbacks)\n    }\n  }\n\n  async join(docId) {\n    const onRealtimeCreated = function(doc) {\n      if (doc.id == docId) {\n        return this.onRealtimeEvent(docId)\n      } else {\n        return undefined\n      }\n    }\n    await Promise.all([\n      this.realtime.subscribe(\n        'created',\n        'io.cozy.notes.events',\n        onRealtimeCreated\n      ),\n      this.realtime.subscribe(\n        'updated',\n        'io.cozy.notes.events',\n        docId,\n        this.onRealtimeEvent\n      ),\n      this.realtime.subscribe(\n        'deleted',\n        'io.cozy.notes.events',\n        docId,\n        this.onRealtimeEvent\n      )\n    ])\n  }\n\n  async onStepsCreated(docId, callback) {\n    this.setCallback('io.cozy.notes.steps', docId, data =>\n      callback(this.server2client(data))\n    )\n  }\n\n  async onTelepointerUpdated(docId, callback) {\n    this.setCallback('io.cozy.notes.telepointers', docId, data =>\n      callback(this.server2client(data))\n    )\n  }\n\n  async onTitleUpdated(docId, callback) {\n    this.setCallback('io.cozy.notes.documents', docId, doc => {\n      return !doc.sessionID || doc.sessionID != this.sessionId\n        ? callback(doc.title)\n        : null\n    })\n  }\n\n  async getDoc(docId) {\n    const res = await this.stackClient.fetchJSON('GET', this.path(docId))\n    return {\n      doc: res.data.attributes.metadata.content,\n      version: res.data.attributes.metadata.version,\n      title: res.data.attributes.metadata.title,\n      file: res.data\n    }\n  }\n\n  async pushSteps(docId, version, steps) {\n    const options = { headers: { 'if-match': version } }\n    const stepsDoc = {\n      data: steps.map(step => ({\n        type: 'io.cozy.notes.steps',\n        attributes: this.client2server(step.toJSON())\n      }))\n    }\n    // will throw in case of 409\n    // which will occurs if the server has more versions than us\n    await this.stackClient.fetchJSON(\n      'PATCH',\n      this.path(docId),\n      stepsDoc,\n      options\n    )\n    return null\n  }\n\n  async getSteps(docId, version) {\n    try {\n      const res = await this.stackClient.fetchJSON(\n        'GET',\n        `${this.path(docId, 'steps')}?Version=${version}`\n      )\n      if (res.data.length == 0) {\n        return { steps: [], version }\n      } else {\n        return {\n          version: res.data[res.data.length - 1].version,\n          steps: res.data.map(step => ({\n            ...step,\n            attributes: this.client2server(step.attributes)\n          }))\n        }\n      }\n    } catch (err) {\n      const response = err.response\n      const data = err.reason && err.reason.data\n      const meta = data && data.attributes && data.attributes.metadata\n      const doc = meta && meta.content\n      const ver = meta && meta.version\n      if (response.status == 412 && doc && ver) {\n        // server does not have all steps we try to fetch\n        // it responds with a full document and a title\n        const ev = 'io.cozy.notes.documents'\n        if (this.callbacks[ev] && this.callbacks[ev][doc.id || doc._id]) {\n          this.callbacks[ev][doc.id || doc._id](doc)\n        }\n        return {\n          doc: doc,\n          version: ver\n        }\n      } else {\n        throw err\n      }\n    }\n  }\n\n  async pushTelepointer(docId, data) {\n    const telepointerDoc = {\n      data: {\n        type: 'io.cozy.notes.telepointers',\n        id: docId,\n        attributes: this.client2server(data)\n      }\n    }\n    return this.stackClient.fetchJSON(\n      'PUT',\n      this.path(docId, 'telepointer'),\n      telepointerDoc\n    )\n  }\n}\nexport default ServiceClient\n","import { Schema } from 'prosemirror-model'\n\n// taken from a debug of @atlakit/editor/editor-core/create-editor/create-editor\n// L139 (new Schema({nodes ,marks}))\n// static because the @atlaskit code base requires a real navigator\n// TODO: either find and exclude plugins requiring interaction\n//       or running a JSDOM faking a navigator\n\nconst nodes = [\n  [\n    'doc',\n    {\n      content: '(block)+',\n      marks: 'link'\n    }\n  ],\n  [\n    'paragraph',\n    {\n      content: 'inline*',\n      group: 'block',\n      marks:\n        'strong code em link strike subsup textColor typeAheadQuery underline',\n      parseDOM: [\n        {\n          tag: 'p'\n        }\n      ]\n    }\n  ],\n  [\n    'text',\n    {\n      group: 'inline'\n    }\n  ],\n  [\n    'bulletList',\n    {\n      group: 'block',\n      content: 'listItem+',\n      parseDOM: [\n        {\n          tag: 'ul'\n        }\n      ]\n    }\n  ],\n  [\n    'orderedList',\n    {\n      group: 'block',\n      content: 'listItem+',\n      parseDOM: [\n        {\n          tag: 'ol'\n        }\n      ]\n    }\n  ],\n  [\n    'listItem',\n    {\n      content: '(paragraph ) (paragraph | bulletList | orderedList )*',\n      defining: true,\n      parseDOM: [\n        {\n          tag: 'li'\n        }\n      ]\n    }\n  ],\n  [\n    'heading',\n    {\n      attrs: {\n        level: {\n          default: 1\n        }\n      },\n      content: 'inline*',\n      group: 'block',\n      defining: true,\n      parseDOM: [\n        {\n          tag: 'h1',\n          attrs: {\n            level: 1\n          }\n        },\n        {\n          tag: 'h2',\n          attrs: {\n            level: 2\n          }\n        },\n        {\n          tag: 'h3',\n          attrs: {\n            level: 3\n          }\n        },\n        {\n          tag: 'h4',\n          attrs: {\n            level: 4\n          }\n        },\n        {\n          tag: 'h5',\n          attrs: {\n            level: 5\n          }\n        },\n        {\n          tag: 'h6',\n          attrs: {\n            level: 6\n          }\n        }\n      ]\n    }\n  ],\n  [\n    'blockquote',\n    {\n      content: 'paragraph+',\n      group: 'block',\n      defining: true,\n      selectable: false,\n      parseDOM: [\n        {\n          tag: 'blockquote'\n        }\n      ]\n    }\n  ],\n  [\n    'rule',\n    {\n      group: 'block',\n      parseDOM: [\n        {\n          tag: 'hr'\n        }\n      ]\n    }\n  ],\n  [\n    'panel',\n    {\n      group: 'block',\n      content: '(paragraph | heading | bulletList | orderedList)+',\n      attrs: {\n        panelType: {\n          default: 'info'\n        }\n      },\n      parseDOM: [\n        {\n          tag: 'div[data-panel-type]'\n        }\n      ]\n    }\n  ],\n  [\n    'confluenceUnsupportedBlock',\n    {\n      group: 'block',\n      attrs: {\n        cxhtml: {\n          default: null\n        }\n      },\n      parseDOM: [\n        {\n          tag: 'div[data-node-type=\"confluenceUnsupportedBlock\"]'\n        }\n      ]\n    }\n  ],\n  [\n    'confluenceUnsupportedInline',\n    {\n      group: 'inline',\n      inline: true,\n      atom: true,\n      attrs: {\n        cxhtml: {\n          default: null\n        }\n      },\n      parseDOM: [\n        {\n          tag: 'div[data-node-type=\"confluenceUnsupportedInline\"]'\n        }\n      ]\n    }\n  ],\n  [\n    'unsupportedBlock',\n    {\n      inline: false,\n      group: 'block',\n      atom: true,\n      selectable: true,\n      attrs: {\n        originalValue: {\n          default: {}\n        }\n      },\n      parseDOM: [\n        {\n          tag: '[data-node-type=\"unsupportedBlock\"]'\n        }\n      ]\n    }\n  ],\n  [\n    'unsupportedInline',\n    {\n      inline: true,\n      group: 'inline',\n      selectable: true,\n      attrs: {\n        originalValue: {\n          default: {}\n        }\n      },\n      parseDOM: [\n        {\n          tag: '[data-node-type=\"unsupportedInline\"]'\n        }\n      ]\n    }\n  ],\n  [\n    'hardBreak',\n    {\n      inline: true,\n      group: 'inline',\n      selectable: false,\n      parseDOM: [\n        {\n          tag: 'br'\n        }\n      ]\n    }\n  ],\n  [\n    'table',\n    {\n      content: 'tableRow+',\n      attrs: {\n        isNumberColumnEnabled: {\n          default: false\n        },\n        layout: {\n          default: 'default'\n        },\n        __autoSize: {\n          default: false\n        }\n      },\n      tableRole: 'table',\n      isolating: true,\n      selectable: false,\n      group: 'block',\n      parseDOM: [\n        {\n          tag: 'table'\n        }\n      ]\n    }\n  ],\n  [\n    'tableHeader',\n    {\n      content:\n        '(paragraph | panel | blockquote | orderedList | bulletList | rule | heading )+',\n      attrs: {\n        colspan: {\n          default: 1\n        },\n        rowspan: {\n          default: 1\n        },\n        colwidth: {\n          default: null\n        },\n        background: {\n          default: null\n        }\n      },\n      tableRole: 'header_cell',\n      isolating: true,\n      marks: '',\n      parseDOM: [\n        {\n          tag: 'th'\n        }\n      ]\n    }\n  ],\n  [\n    'tableRow',\n    {\n      content: '(tableCell | tableHeader)+',\n      tableRole: 'row',\n      parseDOM: [\n        {\n          tag: 'tr'\n        }\n      ]\n    }\n  ],\n  [\n    'tableCell',\n    {\n      content:\n        '(paragraph | panel | blockquote | orderedList | bulletList | rule | heading | unsupportedBlock)+',\n      attrs: {\n        colspan: {\n          default: 1\n        },\n        rowspan: {\n          default: 1\n        },\n        colwidth: {\n          default: null\n        },\n        background: {\n          default: null\n        }\n      },\n      tableRole: 'cell',\n      marks: '',\n      isolating: true,\n      parseDOM: [\n        {\n          tag: '.ak-renderer-table-number-column',\n          ignore: true\n        },\n        {\n          tag: 'td'\n        }\n      ]\n    }\n  ]\n]\n\nconst marks = [\n  [\n    'link',\n    {\n      excludes: 'color',\n      group: 'link',\n      attrs: {\n        href: {},\n        __confluenceMetadata: {\n          default: null\n        }\n      },\n      inclusive: false,\n      parseDOM: [\n        {\n          tag: 'a[href]'\n        }\n      ]\n    }\n  ],\n  [\n    'em',\n    {\n      inclusive: true,\n      group: 'fontStyle',\n      parseDOM: [\n        {\n          tag: 'i'\n        },\n        {\n          tag: 'em'\n        },\n        {\n          style: 'font-style=italic'\n        }\n      ]\n    }\n  ],\n  [\n    'strong',\n    {\n      inclusive: true,\n      group: 'fontStyle',\n      parseDOM: [\n        {\n          tag: 'strong'\n        },\n        {\n          tag: 'b'\n        },\n        {\n          style: 'font-weight'\n        }\n      ]\n    }\n  ],\n  [\n    'textColor',\n    {\n      attrs: {\n        color: {}\n      },\n      inclusive: true,\n      group: 'color',\n      parseDOM: [\n        {\n          style: 'color'\n        }\n      ]\n    }\n  ],\n  [\n    'strike',\n    {\n      inclusive: true,\n      group: 'fontStyle',\n      parseDOM: [\n        {\n          tag: 'strike'\n        },\n        {\n          tag: 's'\n        },\n        {\n          tag: 'del'\n        },\n        {\n          style: 'text-decoration'\n        }\n      ]\n    }\n  ],\n  [\n    'subsup',\n    {\n      inclusive: true,\n      group: 'fontStyle',\n      attrs: {\n        type: {\n          default: 'sub'\n        }\n      },\n      parseDOM: [\n        {\n          tag: 'sub',\n          attrs: {\n            type: 'sub'\n          }\n        },\n        {\n          tag: 'sup',\n          attrs: {\n            type: 'sup'\n          }\n        }\n      ]\n    }\n  ],\n  [\n    'underline',\n    {\n      inclusive: true,\n      group: 'fontStyle',\n      parseDOM: [\n        {\n          tag: 'u'\n        },\n        {\n          style: 'text-decoration'\n        }\n      ]\n    }\n  ],\n  [\n    'code',\n    {\n      excludes: 'fontStyle link searchQuery color',\n      inclusive: true,\n      parseDOM: [\n        {\n          tag: 'span.code',\n          preserveWhitespace: true\n        },\n        {\n          tag: 'code',\n          preserveWhitespace: true\n        },\n        {\n          tag: 'tt',\n          preserveWhitespace: true\n        },\n        {\n          tag: 'span',\n          preserveWhitespace: true\n        }\n      ]\n    }\n  ],\n  [\n    'typeAheadQuery',\n    {\n      excludes: 'searchQuery',\n      inclusive: true,\n      group: 'searchQuery',\n      parseDOM: [\n        {\n          tag: 'span[data-type-ahead-query]'\n        }\n      ],\n      attrs: {\n        trigger: {\n          default: ''\n        }\n      }\n    }\n  ]\n]\n\nfunction orderedToObject(ordered) {\n  return ordered.reduce(function(acc, cur) {\n    acc[cur[0]] = cur[1]\n    return acc\n  }, {})\n}\n\nexport const schemaOrdered = {\n  nodes,\n  marks\n}\n\nexport const schemaObject = {\n  nodes: orderedToObject(nodes),\n  marks: orderedToObject(marks)\n}\n\nconst schema = new Schema(schemaObject)\n\nexport default schema\n","/* eslint-disable import/no-webpack-loader-syntax */\nrequire('expose-loader?React!react')\nrequire('expose-loader?ReactDOM!react-dom')\n","// if you change something here,\n// you should update /lib/collab/schema.js\n// otherwise the server part won't work\nconst editorConfig = {\n  allowTables: true,\n  allowRule: true,\n  allowLists: true,\n  allowTextColor: true,\n  allowPanel: true\n}\n\nexport default editorConfig\n","import React, { useContext } from 'react'\nimport { Link } from 'react-router-dom'\nimport { Button, ButtonLink } from 'cozy-ui/react/Button'\nimport IsPublic from '../IsPublic'\n\nexport default function BackFromEditing({ returnUrl }) {\n  const isPublic = useContext(IsPublic)\n  if (returnUrl) {\n    return (\n      <ButtonLink\n        icon=\"previous\"\n        href={returnUrl}\n        className=\"sto-app-back\"\n        subtle\n      />\n    )\n  } else if (!isPublic) {\n    return (\n      <Button\n        icon=\"previous\"\n        tag={Link}\n        to=\"/\"\n        className=\"sto-app-back\"\n        subtle\n      />\n    )\n  } else {\n    return null\n  }\n}\n","var map = {\n\t\"./_lib/build_formatting_tokens_reg_exp/index.js\": \"kOWh\",\n\t\"./ar/build_distance_in_words_locale/index.js\": \"XxX6\",\n\t\"./ar/build_format_locale/index.js\": \"alis\",\n\t\"./ar/index.js\": \"EDRf\",\n\t\"./be/build_distance_in_words_locale/index.js\": \"LQ09\",\n\t\"./be/build_format_locale/index.js\": \"kj7F\",\n\t\"./be/index.js\": \"YEhR\",\n\t\"./bg/build_distance_in_words_locale/index.js\": \"7K3h\",\n\t\"./bg/build_format_locale/index.js\": \"RrdL\",\n\t\"./bg/index.js\": \"isx8\",\n\t\"./ca/build_distance_in_words_locale/index.js\": \"wqqj\",\n\t\"./ca/build_format_locale/index.js\": \"qcV0\",\n\t\"./ca/index.js\": \"Vwa+\",\n\t\"./cs/build_distance_in_words_locale/index.js\": \"ZKDM\",\n\t\"./cs/build_format_locale/index.js\": \"ipyF\",\n\t\"./cs/index.js\": \"dvhP\",\n\t\"./da/build_distance_in_words_locale/index.js\": \"2Mgc\",\n\t\"./da/build_format_locale/index.js\": \"Gned\",\n\t\"./da/index.js\": \"7ur/\",\n\t\"./de/build_distance_in_words_locale/index.js\": \"5IWf\",\n\t\"./de/build_format_locale/index.js\": \"THCn\",\n\t\"./de/index.js\": \"bgw5\",\n\t\"./el/build_distance_in_words_locale/index.js\": \"o/GB\",\n\t\"./el/build_format_locale/index.js\": \"8T9h\",\n\t\"./el/index.js\": \"dH0v\",\n\t\"./en/build_distance_in_words_locale/index.js\": \"LZbM\",\n\t\"./en/build_format_locale/index.js\": \"6DAA\",\n\t\"./en/index.js\": \"Us+F\",\n\t\"./eo/build_distance_in_words_locale/index.js\": \"qrnn\",\n\t\"./eo/build_format_locale/index.js\": \"Bl15\",\n\t\"./eo/index.js\": \"UB7v\",\n\t\"./es/build_distance_in_words_locale/index.js\": \"GEfZ\",\n\t\"./es/build_format_locale/index.js\": \"O+zC\",\n\t\"./es/index.js\": \"/S0t\",\n\t\"./fi/build_distance_in_words_locale/index.js\": \"VHtQ\",\n\t\"./fi/build_format_locale/index.js\": \"Oydx\",\n\t\"./fi/index.js\": \"ndVD\",\n\t\"./fil/build_distance_in_words_locale/index.js\": \"uq4p\",\n\t\"./fil/build_format_locale/index.js\": \"d7hw\",\n\t\"./fil/index.js\": \"pNfm\",\n\t\"./fr/build_distance_in_words_locale/index.js\": \"IzMR\",\n\t\"./fr/build_format_locale/index.js\": \"I3Zg\",\n\t\"./fr/index.js\": \"LKA2\",\n\t\"./hr/build_distance_in_words_locale/index.js\": \"DPvn\",\n\t\"./hr/build_format_locale/index.js\": \"puw3\",\n\t\"./hr/index.js\": \"L9Jq\",\n\t\"./hu/build_distance_in_words_locale/index.js\": \"w2RQ\",\n\t\"./hu/build_format_locale/index.js\": \"/0iD\",\n\t\"./hu/index.js\": \"Nm+E\",\n\t\"./id/build_distance_in_words_locale/index.js\": \"JbvB\",\n\t\"./id/build_format_locale/index.js\": \"0wlw\",\n\t\"./id/index.js\": \"A6C3\",\n\t\"./is/build_distance_in_words_locale/index.js\": \"qzMC\",\n\t\"./is/build_format_locale/index.js\": \"S3yD\",\n\t\"./is/index.js\": \"N4bE\",\n\t\"./it/build_distance_in_words_locale/index.js\": \"MDEp\",\n\t\"./it/build_format_locale/index.js\": \"aUJd\",\n\t\"./it/index.js\": \"hmb4\",\n\t\"./ja/build_distance_in_words_locale/index.js\": \"nNvt\",\n\t\"./ja/build_format_locale/index.js\": \"buui\",\n\t\"./ja/index.js\": \"uAXs\",\n\t\"./ko/build_distance_in_words_locale/index.js\": \"oEw+\",\n\t\"./ko/build_format_locale/index.js\": \"9SQf\",\n\t\"./ko/index.js\": \"iW8+\",\n\t\"./mk/build_distance_in_words_locale/index.js\": \"nmwZ\",\n\t\"./mk/build_format_locale/index.js\": \"htxJ\",\n\t\"./mk/index.js\": \"GzBU\",\n\t\"./nb/build_distance_in_words_locale/index.js\": \"SL1f\",\n\t\"./nb/build_format_locale/index.js\": \"CJ5F\",\n\t\"./nb/index.js\": \"73vv\",\n\t\"./nl/build_distance_in_words_locale/index.js\": \"Uyu0\",\n\t\"./nl/build_format_locale/index.js\": \"doCD\",\n\t\"./nl/index.js\": \"hCQt\",\n\t\"./pl/build_distance_in_words_locale/index.js\": \"FUBD\",\n\t\"./pl/build_format_locale/index.js\": \"nOYf\",\n\t\"./pl/index.js\": \"B6yL\",\n\t\"./pt/build_distance_in_words_locale/index.js\": \"aTPA\",\n\t\"./pt/build_format_locale/index.js\": \"TTT0\",\n\t\"./pt/index.js\": \"gdks\",\n\t\"./ro/build_distance_in_words_locale/index.js\": \"gI+A\",\n\t\"./ro/build_format_locale/index.js\": \"njjO\",\n\t\"./ro/index.js\": \"r2yp\",\n\t\"./ru/build_distance_in_words_locale/index.js\": \"KmPx\",\n\t\"./ru/build_format_locale/index.js\": \"UUBw\",\n\t\"./ru/index.js\": \"nz/o\",\n\t\"./sk/build_distance_in_words_locale/index.js\": \"q2Bs\",\n\t\"./sk/build_format_locale/index.js\": \"9sxn\",\n\t\"./sk/index.js\": \"Wqan\",\n\t\"./sl/build_distance_in_words_locale/index.js\": \"mlv2\",\n\t\"./sl/build_format_locale/index.js\": \"vHkZ\",\n\t\"./sl/index.js\": \"KYSo\",\n\t\"./sr/build_distance_in_words_locale/index.js\": \"LlkS\",\n\t\"./sr/build_format_locale/index.js\": \"RhjJ\",\n\t\"./sr/index.js\": \"7mU3\",\n\t\"./sv/build_distance_in_words_locale/index.js\": \"UNBN\",\n\t\"./sv/build_format_locale/index.js\": \"zTNB\",\n\t\"./sv/index.js\": \"hxgj\",\n\t\"./th/build_distance_in_words_locale/index.js\": \"XAGa\",\n\t\"./th/build_format_locale/index.js\": \"We2s\",\n\t\"./th/index.js\": \"Pk+z\",\n\t\"./tr/build_distance_in_words_locale/index.js\": \"aFZF\",\n\t\"./tr/build_format_locale/index.js\": \"jh7A\",\n\t\"./tr/index.js\": \"3ZWG\",\n\t\"./zh_cn/build_distance_in_words_locale/index.js\": \"KdB7\",\n\t\"./zh_cn/build_format_locale/index.js\": \"l4EP\",\n\t\"./zh_cn/index.js\": \"8tMq\",\n\t\"./zh_tw/build_distance_in_words_locale/index.js\": \"vyyr\",\n\t\"./zh_tw/build_format_locale/index.js\": \"uYH7\",\n\t\"./zh_tw/index.js\": \"QPlQ\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"nw0P\";","import React, { useState, useEffect, useMemo } from 'react'\nimport { hot } from 'react-hot-loader'\nimport { Route, Switch, HashRouter, withRouter } from 'react-router-dom'\nimport { withClient } from 'cozy-client'\nimport { translate } from 'cozy-ui/transpiled/react/I18n'\nimport { Layout, Main, Content } from 'cozy-ui/react/Layout'\nimport { Sprite as IconSprite } from 'cozy-ui/react/Icon'\nimport Spinner from 'cozy-ui/react/Spinner'\nimport { Empty } from 'cozy-ui/transpiled/react'\n\nimport { List, Editor } from './notes'\nimport { getReturnUrl, getSharedDocument } from './../lib/utils.js'\n\nconst RoutedEditor = withRouter(props => {\n  const returnUrl = getReturnUrl()\n\n  return <Editor noteId={props.match.params.id} returnUrl={returnUrl} />\n})\n\nconst PrivateContext = () => (\n  <Switch>\n    <Route path=\"/n/:id\" component={RoutedEditor} />\n    <Route path=\"/\" component={List} />\n  </Switch>\n)\n\nconst Unshared = translate()(({ t }) => (\n  <Empty\n    icon={'warning-circle'}\n    title={t(`Error.unshared_title`)}\n    text={t(`Error.unshared_text`)}\n  />\n))\n\nconst PublicContext = withClient(({ client }) => {\n  const [sharedDocumentId, setSharedDocumentId] = useState(null)\n  const returnUrl = useMemo(() => getReturnUrl(), [])\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const id = await getSharedDocument(client)\n        setSharedDocumentId(id)\n      } catch {\n        setSharedDocumentId(false)\n      }\n    }\n    fetchData()\n  }, [])\n  if (sharedDocumentId) {\n    return <Editor noteId={sharedDocumentId} returnUrl={returnUrl || false} />\n  } else if (sharedDocumentId !== null) {\n    return <Unshared />\n  } else {\n    return <Spinner size=\"xxlarge\" middle />\n  }\n})\n\nconst App = ({ isPublic }) => (\n  <HashRouter>\n    <Layout monoColumn={true}>\n      <Main>\n        <Content className=\"app-content\">\n          {isPublic ? <PublicContext /> : <PrivateContext />}\n        </Content>\n      </Main>\n      <IconSprite />\n    </Layout>\n  </HashRouter>\n)\n\n/*\n  Enable Hot Module Reload using `react-hot-loader` here\n  We enable it here since App is the main root component\n  No need to use it anywhere else, it sould work for all\n  child components\n*/\nexport default hot(module)(App)\n","module.exports = {\"name\":\"Notes\",\"name_prefix\":\"Cozy\",\"slug\":\"notes\",\"icon\":\"icon.svg\",\"categories\":[],\"version\":\"1.0.7\",\"licence\":\"AGPL-3.0\",\"editor\":\"\",\"source\":\"https://github.com/cozy/cozy-notes.git@build\",\"developer\":{\"name\":\"edas\",\"url\":\"https://eric.daspet.name/\"},\"routes\":{\"/\":{\"folder\":\"/\",\"index\":\"index.html\",\"public\":false},\"/public\":{\"folder\":\"/\",\"index\":\"index.html\",\"public\":true}},\"permissions\":{\"apps\":{\"description\":\"Required by the cozy-bar to display the icons of the apps\",\"type\":\"io.cozy.apps\",\"verbs\":[\"GET\"]},\"files\":{\"description\":\"Notes as files\",\"type\":\"io.cozy.files\"}}}","import get from 'lodash/get'\nimport { isMobile } from 'cozy-device-helper'\nimport {\n  generateWebLink,\n  generateUniversalLink\n} from 'cozy-ui/transpiled/react/AppLinker'\n\nexport function getShortNameFromClient(client) {\n  const url = new URL(client.getStackClient().uri)\n  return url.hostname + Math.floor(Math.random() * 100)\n}\n\nconst returnUrlKey = 'returnUrl'\n\nexport function getReturnUrl() {\n  const searchParams = new URLSearchParams(window.location.search)\n  for (const [key, value] of searchParams) {\n    if (key === returnUrlKey) {\n      return value\n    }\n  }\n  return undefined\n}\n\nexport const generateReturnUrlToNotesIndex = doc => {\n  const url = new URL(window.location)\n  url.searchParams.append(returnUrlKey, window.location.origin)\n  url.hash = `#/n/${doc.id}`\n  return url\n}\nexport async function getSharedDocument(client) {\n  const { data: permissionsData } = await client\n    .collection('io.cozy.permissions')\n    .getOwnPermissions()\n\n  const permissions = permissionsData.attributes.permissions\n  // permissions contains several named keys, but the one to use depends on the situation. Using the first one is what we want in all known cases.\n  const sharedDocumentId = get(Object.values(permissions), '0.values.0')\n\n  return sharedDocumentId\n}\n\nexport function getParentFolderId(file) {\n  return file.relationships.parent.data.id\n}\n\nfunction getFolderLink(id) {\n  return `/folder/${id.replace(/-/g, '')}`\n}\n\nfunction getFullLink(client, id) {\n  const cozyURL = new URL(client.getStackClient().uri)\n  const { cozySubdomainType } = client.getInstanceOptions()\n  const driveSlug = 'drive'\n  const pathForDrive = getFolderLink(id)\n\n  const webUrl = generateWebLink({\n    cozyUrl: cozyURL.origin,\n    slug: driveSlug,\n    subDomainType: cozySubdomainType,\n    nativePath: pathForDrive\n  })\n\n  /** If no mobile, then return the fallback directly. No need\n   * for the universal link\n   */\n  if (!isMobile()) {\n    return webUrl\n  }\n\n  const urlWithUL = generateUniversalLink({\n    slug: driveSlug,\n    fallbackUrl: webUrl,\n    nativePath: pathForDrive,\n    subDomainType: cozySubdomainType\n  })\n  return urlWithUL\n}\n\nexport function getParentFolderLink(client, file) {\n  return getFullLink(client, getParentFolderId(file))\n}\n"],"sourceRoot":""}